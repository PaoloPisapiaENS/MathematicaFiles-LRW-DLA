(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    288466,       7620]
NotebookOptionsPosition[    269961,       7286]
NotebookOutlinePosition[    270421,       7304]
CellTagsIndexPosition[    270378,       7301]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["O(N=-1) Partition Function", "Title",
 CellChangeTimes->{{3.946632022073164*^9, 
  3.9466320349400177`*^9}},ExpressionUUID->"a0f2e223-41ca-ae44-afc0-\
bade21e41e2f"],

Cell[BoxData[{
 RowBox[{"SetOptions", "[", 
  RowBox[{"$FrontEndSession", ",", 
   RowBox[{"NotebookAutoSave", "->", "True"}]}], "]"}], "\n", 
 RowBox[{"NotebookSave", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9464410245825024`*^9, 3.9464410245825024`*^9}, {
  3.946522124356762*^9, 3.946522125740381*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"d33a729d-ad37-1f47-8d81-b5e2850f5f1e"],

Cell["\<\
I want to improve the program that computes the partition function, as well \
generalize it to compute Kay\[CloseCurlyQuote]s theory.
To do so, I want to implement Kay\[CloseCurlyQuote]s trick that spares us the \
burden of expanding Z. 
Let\[CloseCurlyQuote]s start with the definition of the graph.\
\>", "Text",
 CellChangeTimes->{{3.946632040963884*^9, 3.946632180089985*^9}, {
  3.9466322140282*^9, 
  3.9466322288251514`*^9}},ExpressionUUID->"71729c60-6479-ed42-a4ab-\
a58eebcf0641"],

Cell[CellGroupData[{

Cell["MyGraph[]", "Section",
 CellChangeTimes->{{3.946441088396021*^9, 
  3.946441090882208*^9}},ExpressionUUID->"786f8d7a-cd7a-2343-95e9-\
004997b2505d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "MyGraph", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "MyGraph", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<undirected\>\"", " ", "->", "True"}], ",", 
     RowBox[{"\"\<label\>\"", " ", "->", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyGraph", "[", 
   RowBox[{"edges__", ",", "root_", ",", "source_", ",", "\[Beta]_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"locEdges", "=", 
         RowBox[{"{", "}"}]}], ",", "i", ",", 
        RowBox[{"locWeights", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"locRoot", "=", "root"}], ",", 
        RowBox[{"locSource", "=", "source"}], ",", "p"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "<=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Dimensions", "@", "edges"}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<undirected\>\"", "]"}], " ", "&&",
               " ", 
              RowBox[{
               RowBox[{"edges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "=!=", 
               "locSource"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"edges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], " ", "=!=", 
               RowBox[{"edges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], " ", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"locEdges", ",", 
                RowBox[{
                 RowBox[{"edges", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}], "->", 
                 RowBox[{"edges", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"locWeights", ",", 
                RowBox[{"\[Beta]", "[", 
                 RowBox[{
                  RowBox[{"edges", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"edges", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], " ", 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"edges", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "==", "locSource"}], 
             ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"locEdges", ",", 
             RowBox[{
              RowBox[{"edges", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "->", 
              RowBox[{"edges", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"locWeights", ",", 
             RowBox[{"\[Beta]", "[", 
              RowBox[{
               RowBox[{"edges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"edges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], " ", 
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"locEdges", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"locEdges", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<=", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], " ", "&&", 
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<=", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], " ", "&&", 
               RowBox[{
                RowBox[{"#1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<=", 
                RowBox[{"#2", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], " ", "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ",", 
           RowBox[{"\[Beta]", "[", 
            RowBox[{"c_", ",", "d_"}], "]"}]}], "]"}], ":=", 
         RowBox[{"1", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "<=", "c"}], "&&", 
            RowBox[{"b", "<=", "c"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ",", 
           RowBox[{"\[Beta]", "[", 
            RowBox[{"c_", ",", "d_"}], "]"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"-", "1"}], "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", "<=", "a"}], "&&", 
            RowBox[{"d", "<=", "a"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ",", 
           RowBox[{"\[Beta]", "[", 
            RowBox[{"c_", ",", "d_"}], "]"}]}], "]"}], ":=", 
         RowBox[{"1", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", "<", "d"}], "&&", 
            RowBox[{"b", "<=", "d"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{"a_", ",", "b_"}], "]"}], ",", 
           RowBox[{"\[Beta]", "[", 
            RowBox[{"c_", ",", "d_"}], "]"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"-", "1"}], "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", "<", "b"}], "&&", 
            RowBox[{"d", "<=", "b"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"locWeights", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"locWeights", ",", "p"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "locEdges", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "locWeights", "]"}]}], "*)"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<label\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "True", "*)"}], 
         RowBox[{"Graph", "[", 
          RowBox[{"locEdges", ",", 
           RowBox[{"EdgeWeight", "->", "locWeights"}], ",", " ", 
           RowBox[{"EdgeStyle", "->", "Blue"}], ",", " ", 
           RowBox[{"VertexLabels", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"locRoot", "->", 
               RowBox[{
                RowBox[{"ToString", "[", "locRoot", "]"}], "<>", 
                "\"\<, ROOT\>\""}]}], ",", 
              RowBox[{"locSource", "->", 
               RowBox[{
                RowBox[{"ToString", "[", "locSource", "]"}], "<>", 
                "\"\<, SOURCE\>\""}]}], ",", "\"\<Name\>\""}], "}"}]}], ",", 
           " ", 
           RowBox[{"EdgeLabels", "->", "\"\<EdgeWeight\>\""}], ",", " ", 
           RowBox[{"VertexStyle", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"locRoot", "->", "Red"}], ",", 
              RowBox[{"locSource", "->", "Green"}], ",", "Blue"}], "}"}]}], 
           ",", 
           RowBox[{"EdgeShapeFunction", "->", "\"\<FilledArrow\>\""}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "False", "*)"}], 
         RowBox[{"Graph", "[", 
          RowBox[{"locEdges", ",", 
           RowBox[{"EdgeWeight", "->", "locWeights"}], ",", " ", 
           RowBox[{"EdgeStyle", "->", "Blue"}], ",", " ", 
           RowBox[{"VertexLabels", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"locRoot", "->", 
               RowBox[{
                RowBox[{"ToString", "[", "locRoot", "]"}], "<>", 
                "\"\<, ROOT\>\""}]}], ",", 
              RowBox[{"locSource", "->", 
               RowBox[{
                RowBox[{"ToString", "[", "locSource", "]"}], "<>", 
                "\"\<, SOURCE\>\""}]}], ",", "\"\<Name\>\""}], "}"}]}], ",", 
           " ", 
           RowBox[{"VertexStyle", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"locRoot", "->", "Red"}], ",", 
              RowBox[{"locSource", "->", "Green"}], ",", "Blue"}], "}"}]}], 
           ",", 
           RowBox[{"EdgeShapeFunction", "->", "\"\<FilledArrow\>\""}]}], 
          "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", "root", 
    RowBox[{"(*", "Root", "*)"}], ",", "source"}], 
   RowBox[{"(*", "Source", "*)"}], "}"}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9464411376213875`*^9, 3.946441409783098*^9}, {
   3.946441584003025*^9, 3.946441584463972*^9}, {3.9464416379449673`*^9, 
   3.946441639091325*^9}, {3.9464416940456276`*^9, 3.9464416970093536`*^9}, {
   3.94644326521528*^9, 3.946443274028101*^9}, {3.9464433206955147`*^9, 
   3.946443326257669*^9}, {3.9464433688627586`*^9, 3.946443446083992*^9}, {
   3.946443517440826*^9, 3.946443523904392*^9}, {3.946443662006248*^9, 
   3.946443697387224*^9}, {3.94644373344458*^9, 3.946443740967768*^9}, {
   3.946443829785864*^9, 3.946443924843548*^9}, {3.946443997187145*^9, 
   3.9464440035946426`*^9}, {3.946444053363027*^9, 3.946444086686991*^9}, {
   3.946444195440361*^9, 3.946444220112688*^9}, {3.94644425481155*^9, 
   3.9464442748716106`*^9}, {3.946444342494669*^9, 3.9464443650519867`*^9}, {
   3.946444400693908*^9, 3.946444407851888*^9}, {3.9464445637516785`*^9, 
   3.9464445724961605`*^9}, {3.946444624316053*^9, 3.946444634746977*^9}, {
   3.9464447474874783`*^9, 3.946444790714228*^9}, {3.9464462888418083`*^9, 
   3.946446340573259*^9}, {3.9464544024150887`*^9, 3.946454420071207*^9}, {
   3.946454531791767*^9, 3.946454545424898*^9}, {3.946458203654005*^9, 
   3.946458229006527*^9}, {3.946458317680832*^9, 3.946458330307638*^9}, {
   3.946459783141468*^9, 3.9464597860626755`*^9}, {3.946459822565298*^9, 
   3.946459825000469*^9}, {3.946524086547241*^9, 3.946524092311381*^9}, {
   3.946524655261416*^9, 3.9465247177564507`*^9}, {3.946524772773539*^9, 
   3.9465247732782555`*^9}, {3.946525374730724*^9, 3.946525383234647*^9}, 
   3.9465254782639236`*^9, {3.9465287258635483`*^9, 3.946528767289442*^9}, {
   3.946528837956047*^9, 3.946528868980448*^9}, {3.946528970661085*^9, 
   3.946529047648741*^9}, {3.946529207388367*^9, 3.9465292546760406`*^9}, {
   3.946529531023588*^9, 3.946529649450901*^9}, {3.946529791444807*^9, 
   3.946529804357273*^9}, {3.946529984833273*^9, 3.946530003038212*^9}, {
   3.946530064774273*^9, 3.9465301690956593`*^9}, {3.946530234444956*^9, 
   3.946530235709173*^9}, {3.946530281691775*^9, 3.946530312354475*^9}, {
   3.94653050515559*^9, 3.946530530558592*^9}, {3.946540177769327*^9, 
   3.946540226193519*^9}, {3.946540266397789*^9, 3.946540284982237*^9}, {
   3.946540339917501*^9, 3.946540425682848*^9}, {3.9465404940334396`*^9, 
   3.946540496346908*^9}, {3.946540527534212*^9, 3.9465405302951527`*^9}, {
   3.9465405607895584`*^9, 3.946540589197895*^9}, {3.9465406269745064`*^9, 
   3.946540627773033*^9}, {3.946540668215641*^9, 3.9465406790024376`*^9}, {
   3.9465407145017033`*^9, 3.946540715037964*^9}, {3.946541006103271*^9, 
   3.946541077655216*^9}, {3.946541397769346*^9, 3.946541408915283*^9}, {
   3.946541557121928*^9, 3.946541572283837*^9}, {3.946541627003496*^9, 
   3.9465416462805843`*^9}, {3.94654243719305*^9, 3.946542442125183*^9}, {
   3.9465438531362724`*^9, 3.9465439150890236`*^9}, {3.946544173561804*^9, 
   3.94654422800025*^9}, 3.946544318263845*^9, 3.946544375886366*^9, {
   3.946544462128847*^9, 3.9465444857377224`*^9}, {3.946544553596189*^9, 
   3.946544576037269*^9}, {3.9465446080812435`*^9, 3.946544693575228*^9}, {
   3.946544773349371*^9, 3.946544812041962*^9}, {3.9465448957981353`*^9, 
   3.9465448983130226`*^9}, {3.94655540756629*^9, 3.946555409769518*^9}, {
   3.946555489225063*^9, 3.946555505294725*^9}, 3.946632847231186*^9, 
   3.946632908338619*^9, {3.946633427024515*^9, 3.946633547747937*^9}, {
   3.946633592857725*^9, 3.946633621623249*^9}, {3.9467130269006824`*^9, 
   3.946713037131809*^9}, {3.946713187632231*^9, 3.946713199439588*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"c4d1690f-e7a4-5549-ad2a-79f0aa122e5f"],

Cell[CellGroupData[{

Cell["Usage example of MyGraph[]", "Subsection",
 CellChangeTimes->{{3.9464414288391724`*^9, 3.946441434678915*^9}, {
  3.946442963697708*^9, 3.946442963889951*^9}, {3.946527650276404*^9, 
  3.946527655095753*^9}},ExpressionUUID->"f3e50ec4-01de-d54d-96cd-\
4f8287cf06a0"],

Cell["\<\
\[OpenCurlyDoubleQuote]edges\[CloseCurlyDoubleQuote] must be a list of \
ordered pairs containing the vertices of the graph. The edge is intended from \
the first vertex to the second.
If \[OpenCurlyDoubleQuote]directed\[CloseCurlyDoubleQuote] is false \
(optional, default to true), then a undirected graph is drawn\
\>", "Text",
 CellChangeTimes->{{3.946441462008623*^9, 3.9464415328031063`*^9}, {
  3.946441655037653*^9, 3.946441719893234*^9}, {3.9464429656074467`*^9, 
  3.946442966022978*^9}},ExpressionUUID->"762f7555-840b-0c45-9dee-\
ef60631940f7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "g", ",", "edges", ",", "\[Beta]", ",", "root", ",", "source", ",", 
   "printEdgesLabel"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edges", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"root", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"source", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"g", "=", 
  RowBox[{"MyGraph", "[", 
   RowBox[{"edges", ",", "root", ",", "source", ",", "\[Beta]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"g", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"g", "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.94644153587624*^9, 3.9464415716062317`*^9}, {
  3.946444091148647*^9, 3.94644409859288*^9}, {3.9464441555663376`*^9, 
  3.946444171960249*^9}, {3.946444281380485*^9, 3.9464442878480434`*^9}, {
  3.946444375216945*^9, 3.946444376505605*^9}, {3.946458238832554*^9, 
  3.946458239022693*^9}, {3.946458334107992*^9, 3.946458335127506*^9}, {
  3.946524098832722*^9, 3.946524098958678*^9}, {3.9465296371099625`*^9, 
  3.946529644744604*^9}, {3.946529827575369*^9, 3.946529828361777*^9}, {
  3.9465554197686586`*^9, 3.946555420585247*^9}, {3.946633273629696*^9, 
  3.9466332773373585`*^9}, {3.946633309343136*^9, 3.9466333141567135`*^9}, {
  3.9466335558942432`*^9, 3.9466335751233063`*^9}, {3.9466336284022217`*^9, 
  3.9466336449878197`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"a2e09d6d-e664-7748-9a0f-495c53860306"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3}, {{{1, 2}, {2, 1}, {2, 3}, {1, 3}}, Null}, {
        EdgeShapeFunction -> {"FilledArrow"}, EdgeStyle -> {
           RGBColor[0, 0, 1]}, 
         VertexLabels -> {"Name", 2 -> "2, ROOT", 3 -> "3, SOURCE"}, 
         VertexStyle -> {
           RGBColor[0, 0, 1], 3 -> RGBColor[0, 1, 0], 2 -> RGBColor[1, 0, 0]},
          EdgeWeight -> {
           $CellContext`\[Beta][1, 2], 
           $CellContext`\[Beta][2, 1], 
           $CellContext`\[Beta][2, 3], 
           $CellContext`\[Beta][1, 3]}}]]}, 
      TagBox[GraphicsGroupBox[{
         {RGBColor[0, 0, 1], Opacity[0.7], 
          {Arrowheads[{{0.04, 0.8, {
               GraphicsBox[
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
                 0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
                 0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
           ArrowBox[
            BezierCurveBox[{{0.49692220344970944`, 0.}, {0.6063408377933762, 
             0.514847901524803}, {0.9999936327917635, 0.8642449195946471}}]]}, 
          {Arrowheads[{{0.04, 0.8, {
               GraphicsBox[
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
                 0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
                 0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
           ArrowBox[{{0.49692220344970944`, 0.}, {0., 0.8677950027933261}}]}, 
          {Arrowheads[{{0.04, 0.8, {
               GraphicsBox[
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
                 0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
                 0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
           ArrowBox[
            BezierCurveBox[{{0.9999936327917635, 0.8642449195946471}, {
             0.8905749984480927, 0.3493970180698374}, {0.49692220344970944`, 
             0.}}]]}, 
          {Arrowheads[{{0.04, 0.8, {
               GraphicsBox[
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
                 0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
                 0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
           ArrowBox[{{0.9999936327917635, 0.8642449195946471}, {0., 
            0.8677950027933261}}]}}, 
         {RGBColor[0, 0, 1], EdgeForm[{GrayLevel[0], Opacity[
          0.7]}], {DiskBox[{0.49692220344970944`, 0.}, 0.012729918945439149], 
           InsetBox["1", 
            Offset[{2, 2}, {0.5096521223951486, 0.012729918945439149}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           {RGBColor[1, 0, 0], 
            DiskBox[{0.9999936327917635, 0.8642449195946471}, 
             0.012729918945439149]}, 
           InsetBox["\<\"2, ROOT\"\>", 
            Offset[{2, 2}, {1.0127235517372026, 0.8769748385400863}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}, {
           {RGBColor[0, 1, 0], 
            DiskBox[{0., 0.8677950027933261}, 0.012729918945439149]}, 
           InsetBox["\<\"3, SOURCE\"\>", 
            Offset[{2, 2}, {0.012729918945439149, 0.8805249217387653}], 
            ImageScaled[{0, 0}],
            BaseStyle->"Graphics"]}}}],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->"NetworkGraphics",
    FormatType->TraditionalForm,
    FrameTicks->None], ",", "2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.946441572856068*^9, 3.9464415892469864`*^9}, 
   3.94644164217733*^9, {3.946441722403412*^9, 3.946441740432963*^9}, 
   3.94644328575711*^9, {3.94644343475984*^9, 3.946443449147758*^9}, 
   3.9464435268023357`*^9, {3.946443699391945*^9, 3.9464437439825897`*^9}, {
   3.9464438988372326`*^9, 3.946443928606523*^9}, 3.946444007414484*^9, 
   3.946444060076557*^9, 3.946444099995161*^9, {3.946444172997999*^9, 
   3.946444228192713*^9}, {3.946444277916216*^9, 3.946444288215519*^9}, {
   3.946444371588537*^9, 3.946444376792877*^9}, 3.9464444140024967`*^9, 
   3.9464446384715576`*^9, {3.9464447791563625`*^9, 3.946444793249679*^9}, 
   3.9464448278438835`*^9, {3.94644630924654*^9, 3.946446344318866*^9}, 
   3.946454425449003*^9, {3.946454534639553*^9, 3.946454547301361*^9}, 
   3.94645823973591*^9, 3.9464582699154377`*^9, 3.9464583355411816`*^9, 
   3.9464597896762524`*^9, 3.946459829154427*^9, 3.946522134413116*^9, 
   3.946524099652109*^9, 3.9465247791362457`*^9, 3.9465264183917065`*^9, 
   3.946526550403418*^9, 3.9465266095196304`*^9, {3.946529008761479*^9, 
   3.9465290199988823`*^9}, 3.94652905086108*^9, 3.946529259646759*^9, {
   3.946529645235861*^9, 3.946529660325968*^9}, {3.946529807981577*^9, 
   3.946529829054868*^9}, 3.946529989868105*^9, 3.946540433801521*^9, 
   3.946540635338505*^9, 3.946540685245767*^9, 3.9465415754657955`*^9, 
   3.946541653514585*^9, 3.94654392089298*^9, 3.946544233890772*^9, 
   3.9465445805949388`*^9, {3.946544631785164*^9, 3.946544696632042*^9}, 
   3.9465448168920155`*^9, 3.9465555134791737`*^9, 3.946632246806879*^9, 
   3.9466332778943405`*^9, 3.9466333145924587`*^9, {3.9466335518976727`*^9, 
   3.9466335755799026`*^9}, {3.94663362409103*^9, 3.9466336470286617`*^9}, 
   3.9467130455799675`*^9, 3.9467229580819397`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"394a7aca-e5b9-414b-ba17-27bd86156c50"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3}, {{{1, 2}, {2, 1}, {2, 3}, {1, 3}}, Null}, {
      EdgeShapeFunction -> {"FilledArrow"}, EdgeStyle -> {
         RGBColor[0, 0, 1]}, 
       VertexLabels -> {"Name", 2 -> "2, ROOT", 3 -> "3, SOURCE"}, 
       VertexStyle -> {
         RGBColor[0, 0, 1], 3 -> RGBColor[0, 1, 0], 2 -> RGBColor[1, 0, 0]}, 
       EdgeWeight -> {
         $CellContext`\[Beta][1, 2], 
         $CellContext`\[Beta][2, 1], 
         $CellContext`\[Beta][2, 3], 
         $CellContext`\[Beta][1, 3]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {RGBColor[0, 0, 1], Opacity[0.7], 
        {Arrowheads[{{0.04, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[
          BezierCurveBox[{{0.49692220344970944`, 0.}, {0.6063408377933762, 
           0.514847901524803}, {0.9999936327917635, 0.8642449195946471}}]]}, 
        {Arrowheads[{{0.04, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{0.49692220344970944`, 0.}, {0., 0.8677950027933261}}]}, 
        {Arrowheads[{{0.04, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[
          BezierCurveBox[{{0.9999936327917635, 0.8642449195946471}, {
           0.8905749984480927, 0.3493970180698374}, {0.49692220344970944`, 
           0.}}]]}, 
        {Arrowheads[{{0.04, 0.8, {
             GraphicsBox[
              
              FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
               0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
               0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
         ArrowBox[{{0.9999936327917635, 0.8642449195946471}, {0., 
          0.8677950027933261}}]}}, 
       {RGBColor[0, 0, 1], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0.49692220344970944`, 0.}, 0.012729918945439149], 
         InsetBox["1", 
          Offset[{2, 2}, {0.5096521223951486, 0.012729918945439149}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[1, 0, 0], 
          DiskBox[{0.9999936327917635, 0.8642449195946471}, 
           0.012729918945439149]}, 
         InsetBox["\<\"2, ROOT\"\>", 
          Offset[{2, 2}, {1.0127235517372026, 0.8769748385400863}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0, 1, 0], 
          DiskBox[{0., 0.8677950027933261}, 0.012729918945439149]}, 
         InsetBox["\<\"3, SOURCE\"\>", 
          Offset[{2, 2}, {0.012729918945439149, 0.8805249217387653}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->"NetworkGraphics",
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.946441572856068*^9, 3.9464415892469864`*^9}, 
   3.94644164217733*^9, {3.946441722403412*^9, 3.946441740432963*^9}, 
   3.94644328575711*^9, {3.94644343475984*^9, 3.946443449147758*^9}, 
   3.9464435268023357`*^9, {3.946443699391945*^9, 3.9464437439825897`*^9}, {
   3.9464438988372326`*^9, 3.946443928606523*^9}, 3.946444007414484*^9, 
   3.946444060076557*^9, 3.946444099995161*^9, {3.946444172997999*^9, 
   3.946444228192713*^9}, {3.946444277916216*^9, 3.946444288215519*^9}, {
   3.946444371588537*^9, 3.946444376792877*^9}, 3.9464444140024967`*^9, 
   3.9464446384715576`*^9, {3.9464447791563625`*^9, 3.946444793249679*^9}, 
   3.9464448278438835`*^9, {3.94644630924654*^9, 3.946446344318866*^9}, 
   3.946454425449003*^9, {3.946454534639553*^9, 3.946454547301361*^9}, 
   3.94645823973591*^9, 3.9464582699154377`*^9, 3.9464583355411816`*^9, 
   3.9464597896762524`*^9, 3.946459829154427*^9, 3.946522134413116*^9, 
   3.946524099652109*^9, 3.9465247791362457`*^9, 3.9465264183917065`*^9, 
   3.946526550403418*^9, 3.9465266095196304`*^9, {3.946529008761479*^9, 
   3.9465290199988823`*^9}, 3.94652905086108*^9, 3.946529259646759*^9, {
   3.946529645235861*^9, 3.946529660325968*^9}, {3.946529807981577*^9, 
   3.946529829054868*^9}, 3.946529989868105*^9, 3.946540433801521*^9, 
   3.946540635338505*^9, 3.946540685245767*^9, 3.9465415754657955`*^9, 
   3.946541653514585*^9, 3.94654392089298*^9, 3.946544233890772*^9, 
   3.9465445805949388`*^9, {3.946544631785164*^9, 3.946544696632042*^9}, 
   3.9465448168920155`*^9, 3.9465555134791737`*^9, 3.946632246806879*^9, 
   3.9466332778943405`*^9, 3.9466333145924587`*^9, {3.9466335518976727`*^9, 
   3.9466335755799026`*^9}, {3.94663362409103*^9, 3.9466336470286617`*^9}, 
   3.9467130455799675`*^9, 3.946722958581375*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"6ff2f679-0317-6e41-9fcb-cfcec2d02dd5"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.946441572856068*^9, 3.9464415892469864`*^9}, 
   3.94644164217733*^9, {3.946441722403412*^9, 3.946441740432963*^9}, 
   3.94644328575711*^9, {3.94644343475984*^9, 3.946443449147758*^9}, 
   3.9464435268023357`*^9, {3.946443699391945*^9, 3.9464437439825897`*^9}, {
   3.9464438988372326`*^9, 3.946443928606523*^9}, 3.946444007414484*^9, 
   3.946444060076557*^9, 3.946444099995161*^9, {3.946444172997999*^9, 
   3.946444228192713*^9}, {3.946444277916216*^9, 3.946444288215519*^9}, {
   3.946444371588537*^9, 3.946444376792877*^9}, 3.9464444140024967`*^9, 
   3.9464446384715576`*^9, {3.9464447791563625`*^9, 3.946444793249679*^9}, 
   3.9464448278438835`*^9, {3.94644630924654*^9, 3.946446344318866*^9}, 
   3.946454425449003*^9, {3.946454534639553*^9, 3.946454547301361*^9}, 
   3.94645823973591*^9, 3.9464582699154377`*^9, 3.9464583355411816`*^9, 
   3.9464597896762524`*^9, 3.946459829154427*^9, 3.946522134413116*^9, 
   3.946524099652109*^9, 3.9465247791362457`*^9, 3.9465264183917065`*^9, 
   3.946526550403418*^9, 3.9465266095196304`*^9, {3.946529008761479*^9, 
   3.9465290199988823`*^9}, 3.94652905086108*^9, 3.946529259646759*^9, {
   3.946529645235861*^9, 3.946529660325968*^9}, {3.946529807981577*^9, 
   3.946529829054868*^9}, 3.946529989868105*^9, 3.946540433801521*^9, 
   3.946540635338505*^9, 3.946540685245767*^9, 3.9465415754657955`*^9, 
   3.946541653514585*^9, 3.94654392089298*^9, 3.946544233890772*^9, 
   3.9465445805949388`*^9, {3.946544631785164*^9, 3.946544696632042*^9}, 
   3.9465448168920155`*^9, 3.9465555134791737`*^9, 3.946632246806879*^9, 
   3.9466332778943405`*^9, 3.9466333145924587`*^9, {3.9466335518976727`*^9, 
   3.9466335755799026`*^9}, {3.94663362409103*^9, 3.9466336470286617`*^9}, 
   3.9467130455799675`*^9, 3.946722959080744*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"51e352a4-44b2-1d43-a380-d06a09101901"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"gLabel", "=", 
  RowBox[{"MyGraph", "[", 
   RowBox[{"edges", ",", "root", ",", "source", ",", "\[Beta]", ",", 
    RowBox[{"\"\<printEdgesLabel\>\"", "->", "True"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Options", "[", "gLabel", "]"}]}], "Input",
 CellChangeTimes->{{3.9465292689026403`*^9, 3.946529303107185*^9}, {
  3.946529381995903*^9, 3.946529392932472*^9}, {3.9465296312682242`*^9, 
  3.946529631754949*^9}, {3.94652983900114*^9, 3.946529863618599*^9}, {
  3.9465554246057997`*^9, 3.9465554254036016`*^9}, {3.9465555171893067`*^9, 
  3.946555519329029*^9}, {3.9466333306261463`*^9, 3.946633334741028*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"4488a7f2-a843-7145-a876-6f20d3e7e3b9"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3}, {{{1, 2}, {2, 1}, {2, 3}, {1, 3}}, Null}, {
      EdgeLabels -> {"EdgeWeight"}, EdgeShapeFunction -> {"FilledArrow"}, 
       EdgeStyle -> {
         RGBColor[0, 0, 1]}, 
       VertexLabels -> {"Name", 2 -> "2, ROOT", 3 -> "3, SOURCE"}, 
       VertexStyle -> {
         RGBColor[0, 0, 1], 3 -> RGBColor[0, 1, 0], 2 -> RGBColor[1, 0, 0]}, 
       EdgeWeight -> {
         $CellContext`\[Beta][1, 2], 
         $CellContext`\[Beta][2, 1], 
         $CellContext`\[Beta][2, 3], 
         $CellContext`\[Beta][1, 3]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {RGBColor[0, 0, 1], Opacity[0.7], {
         {Arrowheads[{{0.04, 0.8, {
              GraphicsBox[
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
                0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
                0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
          ArrowBox[
           BezierCurveBox[{{0.49692220344970944`, 0.}, {0.6063408377933762, 
            0.514847901524803}, {0.9999936327917635, 0.8642449195946471}}]]}, 
         InsetBox[
          RowBox[{"\[Beta]", "(", 
           RowBox[{"1", ",", "2"}], ")"}], {0.6879607737491111, 0.4673374598512673},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[{{0.04, 0.8, {
              GraphicsBox[
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
                0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
                0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
          ArrowBox[{{0.49692220344970944`, 0.}, {0., 0.8677950027933261}}]}, 
         InsetBox[
          RowBox[{"\[Beta]", "(", 
           RowBox[{"1", ",", "3"}], ")"}], {0.24846110172485472, 0.43389750139666305},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[{{0.04, 0.8, {
              GraphicsBox[
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
                0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
                0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
          ArrowBox[
           BezierCurveBox[{{0.9999936327917635, 0.8642449195946471}, {
            0.8905749984480927, 0.3493970180698374}, {0.49692220344970944`, 
            0.}}]]}, InsetBox[
          RowBox[{"\[Beta]", "(", 
           RowBox[{"2", ",", "1"}], ")"}], {0.8089550624923618, 0.39690745974337976},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {Arrowheads[{{0.04, 0.8, {
              GraphicsBox[
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 
                0}}}, {{{-1., -0.31249915682968066`}, {-0.8749949409780775, \
-8.881784197001252*^-16}, {-1., 0.3124991568296789}, {
                0., -8.881784197001252*^-16}}}]], 0.8749949409780782}}}], 
          ArrowBox[{{0.9999936327917635, 0.8642449195946471}, {0., 
           0.8677950027933261}}]}, InsetBox[
          RowBox[{"\[Beta]", "(", 
           RowBox[{"2", ",", "3"}], ")"}], {0.4999968163958817, 0.8660199611939866},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {RGBColor[0, 0, 1], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0.49692220344970944`, 0.}, 0.012729918945439149], 
         InsetBox["1", 
          Offset[{2, 2}, {0.5096521223951486, 0.012729918945439149}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[1, 0, 0], 
          DiskBox[{0.9999936327917635, 0.8642449195946471}, 
           0.012729918945439149]}, 
         InsetBox["\<\"2, ROOT\"\>", 
          Offset[{2, 2}, {1.0127235517372026, 0.8769748385400863}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0, 1, 0], 
          DiskBox[{0., 0.8677950027933261}, 0.012729918945439149]}, 
         InsetBox["\<\"3, SOURCE\"\>", 
          Offset[{2, 2}, {0.012729918945439149, 0.8805249217387653}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->"NetworkGraphics",
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.946529291311976*^9, 3.946529303313221*^9}, 
   3.946529383125898*^9, 3.9465298640320053`*^9, 3.946555519725855*^9, {
   3.946633327759756*^9, 3.9466333352461586`*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"54532202-b025-0142-a113-7c66a241b54c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"EdgeLabels", "\[Rule]", 
    RowBox[{"{", "\<\"EdgeWeight\"\>", "}"}]}], ",", 
   RowBox[{"EdgeShapeFunction", "\[Rule]", 
    RowBox[{"{", "\<\"FilledArrow\"\>", "}"}]}], ",", 
   RowBox[{"EdgeStyle", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
      "RGBColorSwatchTemplate"], "}"}]}], ",", 
   RowBox[{"VertexLabels", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"Name\"\>", ",", 
      RowBox[{"2", "\[Rule]", "\<\"2, ROOT\"\>"}], ",", 
      RowBox[{"3", "\[Rule]", "\<\"3, SOURCE\"\>"}]}], "}"}]}], ",", 
   RowBox[{"VertexStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[<|"color" -> RGBColor[0, 0, 1]|>,
       "RGBColorSwatchTemplate"], ",", 
      RowBox[{"3", "\[Rule]", 
       TemplateBox[<|"color" -> RGBColor[0, 1, 0]|>,
        "RGBColorSwatchTemplate"]}], ",", 
      RowBox[{"2", "\[Rule]", 
       TemplateBox[<|"color" -> RGBColor[1, 0, 0]|>,
        "RGBColorSwatchTemplate"]}]}], "}"}]}], ",", 
   RowBox[{"EdgeWeight", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], ",", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}], ",", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.946529291311976*^9, 3.946529303313221*^9}, 
   3.946529383125898*^9, 3.9465298640320053`*^9, 3.946555519725855*^9, {
   3.946633327759756*^9, 3.9466333355918255`*^9}},
 CellLabel->"Out[25]=",ExpressionUUID->"58e154e2-df5c-5845-baa3-7dc3dc2e8592"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vertex rules and VertexAssignment[]", "Section",
 CellChangeTimes->{{3.94663269324057*^9, 3.946632695999613*^9}, {
  3.9466336834649143`*^9, 3.946633692398699*^9}, {3.9466339522136707`*^9, 
  3.946633957056181*^9}},ExpressionUUID->"942fdf5b-eea6-534a-971f-\
0437f51d9830"],

Cell["\<\
The vertices are where the interaction takes place in the field theory. \
\>", "Text",
 CellChangeTimes->{{3.946632754332964*^9, 3.9466327651349354`*^9}, {
  3.94663366756295*^9, 
  3.946633679654331*^9}},ExpressionUUID->"fe0f2a7f-16bb-984b-b561-\
73d909146d31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "V", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", "1", "]"}], ":=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "'"}], "[", "a_", "]"}], ":=", "1"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9466327001136627`*^9, 3.946632730988823*^9}, {
   3.946633702219975*^9, 3.946633722159233*^9}, {3.946633767379509*^9, 
   3.946633768421543*^9}, {3.9466338090853558`*^9, 3.946633898003561*^9}, {
   3.946960894842645*^9, 3.9469608970813255`*^9}, {3.9469623825106354`*^9, 
   3.946962401657398*^9}, 3.9469627730017223`*^9, {3.9469639847479*^9, 
   3.946963987307884*^9}, {3.94696402619092*^9, 3.946964027265534*^9}, {
   3.946969708733513*^9, 3.9469697095426025`*^9}, 3.9469701885786057`*^9, {
   3.946970556774626*^9, 3.946970558493035*^9}, {3.946970857487629*^9, 
   3.946970858657788*^9}, {3.946970889038948*^9, 3.9469708899558353`*^9}, {
   3.946971325809749*^9, 3.9469713271262035`*^9}, {3.9469737016311*^9, 
   3.9469737033408527`*^9}, {3.946975805476553*^9, 3.9469758073843994`*^9}, {
   3.946975839385996*^9, 3.9469758398302946`*^9}, 3.947057840259779*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"3159f7aa-122c-8441-9c37-61ddfeeb1078"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "VertexAssignment", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "VertexAssignment", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<system\>\"", "->", "\"\<LERW\>\""}], ",", 
      RowBox[{"\"\<print\>\"", "->", "False"}], ",", 
      RowBox[{"\"\<excludedVertices\>\"", "->", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VertexAssignment", "[", 
   RowBox[{"graph_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "locVertices", ",", "locWeights", ",", "totWeights", ",", "x", ",", 
      "y"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Clear", "[", "i", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"locVertices", "=", 
      RowBox[{"VertexList", "@", "graph"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"locWeights", "=", 
      RowBox[{
       RowBox[{"WeightedAdjacencyMatrix", "[", "graph", "]"}], "//", 
       "Normal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totWeights", " ", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"locWeights", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "LERW", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<system\>\"", "]"}], "==", 
        "\"\<LERW\>\""}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<print\>\"", "]"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<#####   \>\"", "<>", 
            RowBox[{"OptionValue", "[", "\"\<system\>\"", "]"}], "<>", 
            "\"\<   #####\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "\[IndentingNewLine]", 
         RowBox[{"Product", "[", " ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"totWeights", "[", 
                RowBox[{"[", "x", "]"}], "]"}], "===", "0"}], " ", "||", " ", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<excludedVertices\>\"", "]"}],
                 ",", "x"}], "]"}]}], ",", "1", ",", 
             RowBox[{"(", 
              RowBox[{"1", "+", " ", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"locWeights", "[", 
                    RowBox[{"[", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], 
                   RowBox[{"totWeights", "[", 
                    RowBox[{"[", "x", "]"}], "]"}]], 
                  RowBox[{"\[Chi]s", "[", 
                   RowBox[{"y", ",", 
                    SubscriptBox["i", "x"]}], "]"}], 
                  RowBox[{"\[Chi]", "[", 
                   RowBox[{"x", ",", 
                    SubscriptBox["i", "x"]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"y", ",", 
                   RowBox[{"Length", "[", "locVertices", "]"}]}], "}"}]}], 
                "]"}]}], " ", ")"}]}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Length", "[", "locVertices", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "DLA", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<system\>\"", "]"}], "==", 
        "\"\<DLA\>\""}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<print\>\"", "]"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<#####   \>\"", "<>", 
            RowBox[{"OptionValue", "[", "\"\<system\>\"", "]"}], "<>", 
            "\"\<   #####\>\""}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "\[IndentingNewLine]", 
         RowBox[{"Product", "[", " ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"totWeights", "[", 
                RowBox[{"[", "x", "]"}], "]"}], "===", "0"}], " ", "||", " ", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<excludedVertices\>\"", "]"}],
                 ",", "x"}], "]"}]}], ",", "1", ",", 
             RowBox[{"(", 
              RowBox[{"1", "+", " ", 
               RowBox[{
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"1", "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"locWeights", "[", 
                    RowBox[{"[", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], 
                    RowBox[{"totWeights", "[", 
                    RowBox[{"[", "x", "]"}], "]"}]], 
                    RowBox[{"\[Chi]s", "[", 
                    RowBox[{"y", ",", 
                    SubscriptBox["i", "x"]}], "]"}]}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"y", ",", 
                    RowBox[{"Length", "[", "locVertices", "]"}]}], "}"}]}], 
                 "]"}], " ", 
                RowBox[{"\[Chi]", "[", 
                 RowBox[{"x", ",", 
                  SubscriptBox["i", "x"]}], "]"}]}], "+", " ", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"locWeights", "[", 
                    RowBox[{"[", 
                    RowBox[{"x", ",", "y"}], "]"}], "]"}], 
                   RowBox[{"totWeights", "[", 
                    RowBox[{"[", "x", "]"}], "]"}]], 
                  RowBox[{"\[Phi]s", "[", 
                   RowBox[{"y", ",", 
                    SubscriptBox["j", "x"]}], "]"}], 
                  RowBox[{"\[Phi]", "[", 
                   RowBox[{"x", ",", 
                    SubscriptBox["j", "x"]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"y", ",", 
                   RowBox[{"Length", "[", "locVertices", "]"}]}], "}"}]}], 
                "]"}]}], ")"}]}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Length", "[", "locVertices", "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.946633962841484*^9, 3.946634004878586*^9}, {
   3.9466340591481705`*^9, 3.9466342876622133`*^9}, {3.946634328830078*^9, 
   3.946634359292324*^9}, 3.946634439957023*^9, {3.9466344920513515`*^9, 
   3.946634521904953*^9}, {3.946634640935534*^9, 3.94663470764571*^9}, {
   3.946634764072651*^9, 3.9466349073067093`*^9}, {3.946634959293289*^9, 
   3.946635013215481*^9}, {3.9466350448751717`*^9, 3.94663504662253*^9}, {
   3.946635115000442*^9, 3.946635126602049*^9}, {3.946635159876623*^9, 
   3.946635200624071*^9}, {3.9466352595486317`*^9, 3.9466352893226547`*^9}, {
   3.946722078632084*^9, 3.946722084344204*^9}, {3.946976819067518*^9, 
   3.9469768526506615`*^9}, {3.946983287504944*^9, 3.946983325470138*^9}, {
   3.946983372150404*^9, 3.946983415574913*^9}, {3.946983500202915*^9, 
   3.946983505274193*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"db7e8836-8040-e740-ab88-d7aeebd7bfeb"],

Cell[CellGroupData[{

Cell["Usage example of VertexAssignment[]", "Subsection",
 CellChangeTimes->{{3.946634373586445*^9, 
  3.9466343889578648`*^9}},ExpressionUUID->"5bf8cdd6-e456-6f4f-848f-\
884a07a83784"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Z", "=", 
  RowBox[{"VertexAssignment", "[", 
   RowBox[{
    RowBox[{"g", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"\"\<system\>\"", "->", "\"\<LERW\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.946634393176319*^9, 3.9466343987713184`*^9}, {
  3.9466348665300007`*^9, 3.9466348749892654`*^9}, {3.9466349283603497`*^9, 
  3.946634932529684*^9}, {3.9466361877327366`*^9, 3.946636192510212*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"54bf71a2-b5ec-3d47-88e2-1188593be31a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "1"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "1"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"3", ",", 
        SubscriptBox["i", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}]]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "2"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"3", ",", 
        SubscriptBox["i", "2"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.9466349100647564`*^9, 3.946634932972599*^9}, 
   3.9466349759768715`*^9, 3.9466350173756104`*^9, 3.9466350497929726`*^9, 
   3.946635129240673*^9, 3.9466352042279053`*^9, 3.946635296791868*^9, {
   3.9466361880320377`*^9, 3.9466361931437607`*^9}, {3.946722947655731*^9, 
   3.946722966921116*^9}, 3.946976863850672*^9, 3.9469769165526104`*^9, {
   3.94698348652223*^9, 3.9469835095988865`*^9}},
 CellLabel->
  "Out[212]=",ExpressionUUID->"d9fed051-3042-444d-9f6d-a3ccce66401f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VertexAssignment", "[", 
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"\"\<system\>\"", "->", "\"\<LERW\>\""}], ",", 
   RowBox[{"\"\<excludedVertices\>\"", "->", 
    RowBox[{"{", "1", "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9469834240177746`*^9, 3.946983465055044*^9}, 
   3.946983522822445*^9},
 CellLabel->
  "In[214]:=",ExpressionUUID->"1a852724-628d-3741-93af-8fd861028ce1"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], " ", 
    RowBox[{"\[Chi]", "[", 
     RowBox[{"2", ",", 
      SubscriptBox["i", "2"]}], "]"}], " ", 
    RowBox[{"\[Chi]s", "[", 
     RowBox[{"1", ",", 
      SubscriptBox["i", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "3"}], "]"}], " ", 
    RowBox[{"\[Chi]", "[", 
     RowBox[{"2", ",", 
      SubscriptBox["i", "2"]}], "]"}], " ", 
    RowBox[{"\[Chi]s", "[", 
     RowBox[{"3", ",", 
      SubscriptBox["i", "2"]}], "]"}]}], 
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.9469834503296375`*^9, 3.946983470939234*^9}, {
  3.9469835141453724`*^9, 3.946983523515339*^9}},
 CellLabel->
  "Out[214]=",ExpressionUUID->"c43bb2c1-c040-0747-9124-1f78f887d64b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Delta]rules", "Section",
 CellChangeTimes->{{3.9467116268830776`*^9, 3.9467116301128864`*^9}, 
   3.946711742502907*^9},ExpressionUUID->"a2c15434-00a5-1046-99b7-\
6b6dad2cb4d2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalSigma]\[Delta]rule", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]\[Delta]rule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "n_"], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a", ",", "b"}], "]"}], 
        RowBox[{"n", "-", "2"}]], 
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "a"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"b_", ",", "a_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"c_", ",", "b_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"c", ",", "a"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"c_", ",", "b_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "c"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "a", "]"}]}], ")"}]}], ":>", "n"}]}], 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.946712022110813*^9, 3.946712105883018*^9}, {
  3.9467121427712345`*^9, 3.9467122045025067`*^9}, {3.9467122379478264`*^9, 
  3.946712251145956*^9}, {3.946712281685026*^9, 3.946712320735409*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"d59eaaf1-117b-954d-bc47-5fd957e1a5e2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[Delta]ruleExternal", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]ruleExternal", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], ":>", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"a", "==", "b"}]}], ")"}]}], ":>", "0"}]}], " ", "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.946712341856528*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"515c84b6-0497-1743-b842-40bcf1b416f6"],

Cell[CellGroupData[{

Cell["Usage examples of the \[Delta]rules", "Subsection",
 CellChangeTimes->{{3.9467117866097736`*^9, 
  3.9467118019427814`*^9}},ExpressionUUID->"c45f1d94-0f68-604d-b333-\
98dd93c2c294"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"b", ",", "a"}], "]"}], 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"c", ",", "b"}], "]"}]}], "/.", 
  "\[CapitalSigma]\[Delta]rule"}]], "Input",
 CellChangeTimes->{{3.9467118199505367`*^9, 3.9467118371105785`*^9}},
 CellLabel->
  "In[569]:=",ExpressionUUID->"d8a193d6-b365-5a4d-80c2-121376ada22f"],

Cell[BoxData[
 RowBox[{"\[Delta]", "[", 
  RowBox[{"c", ",", "a"}], "]"}]], "Output",
 CellChangeTimes->{{3.9467118311683865`*^9, 3.9467118375831394`*^9}, {
   3.9467121638834553`*^9, 3.946712207342287*^9}, 3.946712254246296*^9, 
   3.946712308829298*^9},
 CellLabel->
  "Out[569]=",ExpressionUUID->"a51ceec1-fef5-604b-aba2-62392b34df30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"b", ",", "a"}], "]"}], 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], "//.", 
  "\[CapitalSigma]\[Delta]rule"}]], "Input",
 CellChangeTimes->{{3.946711850352009*^9, 3.946711854475006*^9}},
 CellLabel->
  "In[570]:=",ExpressionUUID->"f769d7df-def1-8b4a-9504-e6aeae032a74"],

Cell[BoxData["n"], "Output",
 CellChangeTimes->{3.94671185472666*^9, 3.9467122100701275`*^9, 
  3.946712256045767*^9, 3.9467123105920506`*^9},
 CellLabel->
  "Out[570]=",ExpressionUUID->"65be1f3b-2e7a-9e47-989b-238a4cd51b3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]", "[", 
    RowBox[{"b", ",", "a"}], "]"}], 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"c", ",", "a"}], "]"}], 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"c", ",", "b"}], "]"}]}], "//.", 
  "\[CapitalSigma]\[Delta]rule"}]], "Input",
 CellChangeTimes->{{3.9467118766907024`*^9, 3.946711885568964*^9}},
 CellLabel->
  "In[574]:=",ExpressionUUID->"af0133a1-c660-924c-9060-6dfd430f18c4"],

Cell[BoxData["n"], "Output",
 CellChangeTimes->{
  3.9467118862001705`*^9, 3.946712212858162*^9, 3.946712257980896*^9, {
   3.9467123122352524`*^9, 3.9467123245711403`*^9}},
 CellLabel->
  "Out[574]=",ExpressionUUID->"69b0c013-5bd8-fc48-b027-d20cb6a8ee4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{"1", ",", "i"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"i", ",", "1"}], "]"}]}], "//.", "\[CapitalSigma]\[Delta]rule"}],
   "//.", "\[Delta]ruleExternal"}]], "Input",
 CellChangeTimes->{{3.946712365128233*^9, 3.946712402077961*^9}},
 CellLabel->
  "In[577]:=",ExpressionUUID->"36fb3397-f498-764b-a7d8-6d010e0ab158"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.946712419062029*^9},
 CellLabel->
  "Out[577]=",ExpressionUUID->"11c1f0cb-f685-0845-9373-02a82807c901"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{"1", ",", "i"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"i", ",", "2"}], "]"}]}], "//.", "\[CapitalSigma]\[Delta]rule"}],
   "//.", "\[Delta]ruleExternal"}]], "Input",
 CellChangeTimes->{{3.946712365128233*^9, 3.9467124162435913`*^9}},
 CellLabel->
  "In[576]:=",ExpressionUUID->"53d63093-299c-454e-b79e-285fbcfdcc88"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.946712416535141*^9},
 CellLabel->
  "Out[576]=",ExpressionUUID->"94edd3cb-fd7b-a148-899a-43bfb194a0d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{"1", ",", "i"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"i", ",", "1"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"a", ",", "b"}], "]"}], 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "//.", "\[CapitalSigma]\[Delta]rule"}],
   "//.", "\[Delta]ruleExternal"}]], "Input",
 CellChangeTimes->{{3.946712365128233*^9, 3.946712438825142*^9}},
 CellLabel->
  "In[578]:=",ExpressionUUID->"0bcefcd6-aba8-4940-894b-3478f723bc9e"],

Cell[BoxData["n"], "Output",
 CellChangeTimes->{3.9467124393455257`*^9},
 CellLabel->
  "Out[578]=",ExpressionUUID->"b1a318ac-22da-6942-82a8-63fe80d76456"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["WickContraction[]", "Section",
 CellChangeTimes->{{3.9466353618042946`*^9, 3.9466353654389706`*^9}, {
  3.946635665582222*^9, 
  3.9466356661679783`*^9}},ExpressionUUID->"6c013ccf-6700-5943-89ed-\
25a319a30c0e"],

Cell["NOW IT WORKS!!!", "Text",
 CellChangeTimes->{{3.9470593800321865`*^9, 
  3.947059382850237*^9}},ExpressionUUID->"9efd4005-5c4e-ac42-82b5-\
48fbdc4cb51c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "WickContraction", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"/.", " ", 
    RowBox[{
     RowBox[{"1", "+", "c_"}], "->", 
     RowBox[{"\[Kappa]", "+", "1", "+", "c"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "WickContraction", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"\"\<print\>\"", "->", "False"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WickContraction", "[", 
    RowBox[{"A_", " ", "+", "B_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"WickContraction", "[", "A", "]"}], "+", 
    RowBox[{"WickContraction", "[", "B", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WickContraction", "[", 
     RowBox[{"A_", " ", "+", "B_", "+", "C_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"WickContraction", "[", "A", "]"}], "+", 
     RowBox[{"WickContraction", "[", 
      RowBox[{"B", "+", "C"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WickContraction", "[", 
     RowBox[{"A_", "?", "NumericQ"}], "]"}], ":=", "A"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
         "There", " ", "are", " ", "two", " ", "possible", " ", 
          "contributions", " ", "for", " ", "each", " ", 
          RowBox[{"field", ":", " ", "1"}]}], ")"}], " ", "it", " ", "is", 
        " ", "not", " ", 
        RowBox[{"contracted", ":", " ", "\[Chi]"}]}], "->", "0"}], ";", " ", 
      "2"}], ")"}], " ", "it", " ", "is", " ", "contracted"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WickContraction", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "A_", "]"}], " ", "*", "B_"}], ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"contributions", "=", "0"}], ",", "z", ",", "zTemp", ",", 
       "\[Kappa]", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z", "=", 
       RowBox[{
        RowBox[{"V", "[", "A", "]"}], "B"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"contributions", "=", "z"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", "100"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"First", " ", "contribution"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"zTemp", "=", 
          RowBox[{
           RowBox[{"z", "/.", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"j", ",", "a_"}], "]"}], "->", "0"}]}], "/.", 
           RowBox[{
            RowBox[{"\[Chi]s", "[", 
             RowBox[{"j", ",", "b_"}], "]"}], "->", "0"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zTemp", "-", "z"}], "=!=", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"z", "+=", "zTemp"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Second", " ", "contribution"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"zTemp", "=", 
          RowBox[{"z", "/.", " ", 
           RowBox[{
            RowBox[{"\[Chi]", "[", 
             RowBox[{"j", ",", "a_"}], "]"}], "->", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"j", ",", "a"}], "]"}], "+", 
             RowBox[{"\[Kappa]", " ", "*", 
              RowBox[{"\[Delta]\[Chi]", "[", 
               RowBox[{"j", ",", "a"}], "]"}]}]}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zTemp", "-", "z"}], "=!=", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"z", "=", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"zTemp", ",", "\[Kappa]"}], "]"}], "/.", 
              RowBox[{"\[Kappa]", "->", "0"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"zTemp", "=", 
          RowBox[{"z", "/.", " ", 
           RowBox[{
            RowBox[{"\[Chi]s", "[", 
             RowBox[{"j", ",", "a_"}], "]"}], "->", 
            RowBox[{
             RowBox[{"\[Chi]s", "[", 
              RowBox[{"j", ",", "a"}], "]"}], "+", 
             RowBox[{"\[Kappa]", " ", "*", 
              RowBox[{"\[Delta]\[Chi]s", "[", 
               RowBox[{"j", ",", "a"}], "]"}]}]}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zTemp", "-", "z"}], "=!=", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"z", "=", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"zTemp", ",", "\[Kappa]"}], "]"}], "/.", 
              RowBox[{"\[Kappa]", "->", "0"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<print\>\"", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<#### \>\"", "<>", 
                 RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\< ####\>\""}],
                 "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", "z", "]"}]}]}], "\[IndentingNewLine]", 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"z", "=", 
          RowBox[{"Expand", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"zTemp", "=", 
          RowBox[{"z", "//.", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Delta]\[Chi]", "[", 
               RowBox[{"j", ",", "a_"}], "]"}], "*", 
              RowBox[{"\[Delta]\[Chi]s", "[", 
               RowBox[{"j", ",", "b_"}], "]"}]}], "/;", 
             RowBox[{"(", 
              RowBox[{"!", 
               RowBox[{"NumericQ", "[", 
                RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
            RowBox[{"\[Delta]", "[", 
             RowBox[{"a", ",", "b"}], "]"}]}]}]}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zTemp", "-", "z"}], "=!=", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<print\>\"", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<#### Contraction \>\"", "<>", 
                RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\< ####\>\""}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"z", "=", "zTemp"}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"z", "=", 
          RowBox[{
           RowBox[{"zTemp", "/.", 
            RowBox[{
             RowBox[{"\[Delta]\[Chi]", "[", 
              RowBox[{"j", ",", "a_"}], "]"}], "->", "0"}]}], "/.", 
           RowBox[{
            RowBox[{"\[Delta]\[Chi]s", "[", 
             RowBox[{"j", ",", "b_"}], "]"}], "->", "0"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"contributions", "-", "z"}], "=!=", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"contributions", "+=", "z"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"z", "=", "contributions"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{"z", "/.", 
        RowBox[{
         RowBox[{"\[Chi]", "[", 
          RowBox[{"x_", ",", "a_"}], "]"}], "->", "0"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{"z", "/.", 
        RowBox[{
         RowBox[{"\[Chi]s", "[", 
          RowBox[{"y_", ",", "b_"}], "]"}], "->", "0"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{"z", "//.", "\[CapitalSigma]\[Delta]rule"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "z", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"WickContraction", "[", 
      RowBox[{"V", "[", "A_", "]"}], " ", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "zTemp", ",", "\[Kappa]", ",", "j"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"z", "=", 
           RowBox[{"V", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<=", "100"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"zTemp", "=", 
              RowBox[{
               RowBox[{"z", "/.", " ", 
                RowBox[{
                 RowBox[{"1", "+", "c_"}], "->", 
                 RowBox[{"\[Kappa]", "+", "1", "+", "c"}]}]}], "/.", 
               RowBox[{
                RowBox[{"\[Chi]", "[", 
                 RowBox[{"j", ",", "a_"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"\[Chi]", "[", 
                  RowBox[{"j", ",", "a"}], "]"}], "+", 
                 RowBox[{"\[Kappa]", " ", 
                  RowBox[{"\[Delta]\[Chi]", "[", 
                   RowBox[{"j", ",", "a"}], "]"}]}]}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"z", "=", 
              RowBox[{"z", "/.", " ", 
               RowBox[{
                RowBox[{"1", "+", "c_"}], "->", 
                RowBox[{"\[Kappa]", "+", "1", "+", "c"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"zTemp", "-", "z"}], "=!=", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"z", "=", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"zTemp", ",", "\[Kappa]"}], "]"}], "/.", 
                 RowBox[{"\[Kappa]", "->", "0"}]}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"z", "=", 
              RowBox[{"z", "/.", 
               RowBox[{"\[Kappa]", "->", "0"}]}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"zTemp", "=", 
              RowBox[{
               RowBox[{"z", "/.", " ", 
                RowBox[{
                 RowBox[{"1", "+", "c_"}], "->", 
                 RowBox[{"\[Kappa]", "+", "1", "+", "c"}]}]}], "/.", 
               RowBox[{
                RowBox[{"\[Chi]s", "[", 
                 RowBox[{"j", ",", "a_"}], "]"}], "->", 
                RowBox[{
                 RowBox[{"\[Chi]s", "[", 
                  RowBox[{"j", ",", "a"}], "]"}], "+", 
                 RowBox[{"\[Kappa]", " ", 
                  RowBox[{"\[Delta]\[Chi]s", "[", 
                   RowBox[{"j", ",", "a"}], "]"}]}]}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"z", "=", 
              RowBox[{"z", "/.", " ", 
               RowBox[{
                RowBox[{"1", "+", "c_"}], "->", 
                RowBox[{"\[Kappa]", "+", "1", "+", "c"}]}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"zTemp", "-", "z"}], "=!=", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"z", "=", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"zTemp", ",", "\[Kappa]"}], "]"}], "/.", 
                 RowBox[{"\[Kappa]", "->", "0"}]}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"z", "=", 
              RowBox[{"z", "/.", 
               RowBox[{"\[Kappa]", "->", "0"}]}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"z", "=", 
              RowBox[{"Expand", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"z", "=", 
              RowBox[{"z", "//.", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Delta]\[Chi]", "[", 
                   RowBox[{"j", ",", "a_"}], "]"}], "*", 
                  RowBox[{"\[Delta]\[Chi]s", "[", 
                   RowBox[{"j", ",", "b_"}], "]"}]}], "/;", 
                 RowBox[{"(", 
                  RowBox[{"!", 
                   RowBox[{"NumericQ", "[", 
                    RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
                RowBox[{"\[Delta]", "[", 
                 RowBox[{"a", ",", "b"}], "]"}]}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"z", "=", 
           RowBox[{"z", "/.", 
            RowBox[{
             RowBox[{"\[Chi]", "[", 
              RowBox[{"x_", ",", "a_"}], "]"}], "->", "0"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"z", "=", 
           RowBox[{"z", "/.", 
            RowBox[{
             RowBox[{"\[Chi]s", "[", 
              RowBox[{"y_", ",", "b_"}], "]"}], "->", "0"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"z", "=", 
           RowBox[{"z", "//.", "\[CapitalSigma]\[Delta]rule"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "z", "]"}]}]}], "\[IndentingNewLine]", "]"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"WickContraction", "[", 
        RowBox[{"A_", " ", 
         RowBox[{"\[Beta]", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}]}], "]"}]}], ":=", 
      RowBox[{"A", " ", 
       RowBox[{"\[Beta]", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}]}]}], ";"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.94663538489089*^9, 3.946635396197609*^9}, {
   3.946635548246996*^9, 3.946635574387649*^9}, {3.946635668122076*^9, 
   3.946635676404009*^9}, {3.946635707948225*^9, 3.94663572452273*^9}, 
   3.946635756865008*^9, {3.946635788234358*^9, 3.9466358411968975`*^9}, {
   3.946635885560114*^9, 3.946635887698808*^9}, {3.946635995876859*^9, 
   3.9466360518458786`*^9}, {3.946636095537182*^9, 3.946636127321642*^9}, {
   3.946636202908039*^9, 3.946636222066723*^9}, {3.946636349527737*^9, 
   3.946636364121973*^9}, {3.946636400251629*^9, 3.946636461630203*^9}, {
   3.946712504774067*^9, 3.946712530413255*^9}, {3.946712562213129*^9, 
   3.946712562726597*^9}, {3.946712611351045*^9, 3.946712671181914*^9}, {
   3.9467140283251705`*^9, 3.9467141029636345`*^9}, {3.946714162178524*^9, 
   3.946714244431816*^9}, {3.946714328101164*^9, 3.946714329407753*^9}, {
   3.9467143693828487`*^9, 3.946714409373541*^9}, {3.94671446028397*^9, 
   3.946714510071783*^9}, {3.946714651591921*^9, 3.946714658718498*^9}, {
   3.9467146890529613`*^9, 3.946714704384711*^9}, {3.946714742913361*^9, 
   3.946714781420616*^9}, 3.9467148144971066`*^9, {3.946714859230156*^9, 
   3.946714865465451*^9}, {3.946714911655985*^9, 3.946714919986208*^9}, {
   3.9467151220744877`*^9, 3.9467151516634808`*^9}, {3.9467191564277687`*^9, 
   3.946719163297741*^9}, {3.946719206204172*^9, 3.9467192285006866`*^9}, {
   3.946719437060236*^9, 3.9467194895645843`*^9}, {3.946719548816529*^9, 
   3.9467196112045784`*^9}, {3.946721870838423*^9, 3.9467218888807173`*^9}, {
   3.946721940286351*^9, 3.946721942672739*^9}, {3.946722370787201*^9, 
   3.9467224397823944`*^9}, {3.9467231981739635`*^9, 3.946723242159123*^9}, {
   3.9467235014745617`*^9, 3.946723541909678*^9}, {3.9467235892222996`*^9, 
   3.9467236252052517`*^9}, {3.946723665252379*^9, 3.946723693128078*^9}, {
   3.946723753709884*^9, 3.946723782088835*^9}, {3.946723816218687*^9, 
   3.946723819898409*^9}, {3.946723887849617*^9, 3.9467239379394684`*^9}, {
   3.946724081617771*^9, 3.946724092540369*^9}, {3.9467241392986183`*^9, 
   3.94672414500708*^9}, {3.9467241931942396`*^9, 3.946724196147316*^9}, {
   3.9467242394205704`*^9, 3.9467242430905952`*^9}, {3.9467243218910217`*^9, 
   3.94672433035561*^9}, {3.946724363028313*^9, 3.946724365236235*^9}, {
   3.946724407638577*^9, 3.946724452637469*^9}, 3.9467244899566135`*^9, {
   3.94672453408996*^9, 3.94672461496085*^9}, {3.946724656233078*^9, 
   3.94672472869105*^9}, {3.946724791285639*^9, 3.9467248101618443`*^9}, {
   3.946725518248514*^9, 3.946725528727703*^9}, {3.946725662991986*^9, 
   3.9467257264236965`*^9}, 3.946725828904425*^9, {3.946960598886971*^9, 
   3.946960611268318*^9}, 3.94696066131139*^9, {3.946960692325773*^9, 
   3.946960698820919*^9}, {3.946961971577391*^9, 3.946961979658901*^9}, {
   3.9469620547883053`*^9, 3.946962057418907*^9}, {3.94696208969169*^9, 
   3.946962153006637*^9}, {3.946963207424919*^9, 3.946963243261791*^9}, {
   3.9469633423561997`*^9, 3.946963429078499*^9}, {3.946963602841223*^9, 
   3.946963625015812*^9}, {3.946963761501553*^9, 3.9469637641906776`*^9}, {
   3.946963850978788*^9, 3.946963852813038*^9}, {3.946963967984745*^9, 
   3.946963971868437*^9}, {3.946964171722344*^9, 3.9469642111947*^9}, {
   3.946964285736811*^9, 3.946964300651106*^9}, {3.946964351603716*^9, 
   3.9469643542011814`*^9}, {3.9469646096121387`*^9, 3.946964619291706*^9}, {
   3.94696478873634*^9, 3.946964795335552*^9}, {3.946964864576481*^9, 
   3.946964923989212*^9}, {3.9469650576758766`*^9, 3.946965122398422*^9}, {
   3.9469653503517513`*^9, 3.9469653652915287`*^9}, {3.946965418546608*^9, 
   3.946965431287777*^9}, 3.9469654777606964`*^9, {3.946973683708008*^9, 
   3.946973763668665*^9}, {3.946973796010895*^9, 3.946973813839329*^9}, 
   3.9469738556082973`*^9, {3.946973955221794*^9, 3.946973958892332*^9}, {
   3.946974135911476*^9, 3.946974142577456*^9}, {3.9469742516787796`*^9, 
   3.946974253541807*^9}, {3.946974322054657*^9, 3.946974365337813*^9}, {
   3.946974446443577*^9, 3.9469744600577755`*^9}, {3.946974508500759*^9, 
   3.946974511687592*^9}, {3.94697456487662*^9, 3.946974585665434*^9}, {
   3.946974662894427*^9, 3.94697466510823*^9}, {3.946974842399996*^9, 
   3.946974930960903*^9}, {3.946975091494844*^9, 3.946975098468511*^9}, {
   3.946975876433874*^9, 3.946975907613455*^9}, {3.9469760398903503`*^9, 
   3.946976063399858*^9}, {3.946976093627959*^9, 3.946976198218092*^9}, {
   3.946976313831863*^9, 3.9469763776637974`*^9}, {3.9469764186513786`*^9, 
   3.946976435239004*^9}, {3.94697648529657*^9, 3.9469765194674244`*^9}, {
   3.947057912691452*^9, 3.947057915867417*^9}, {3.947058299305635*^9, 
   3.947058330786131*^9}, {3.9470583826646137`*^9, 3.9470584100675545`*^9}, {
   3.947058450811985*^9, 3.947058592674631*^9}, {3.947058688568531*^9, 
   3.947058765004284*^9}, {3.947058795868992*^9, 3.947058937129144*^9}, {
   3.947059015191725*^9, 3.947059032479849*^9}, {3.94705913973179*^9, 
   3.9470591636817703`*^9}, {3.947059217960501*^9, 3.9470592475236206`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"c588350e-729f-e341-8de4-dd68d96b95d2"],

Cell[CellGroupData[{

Cell["Usage example of WickContraction[]", "Subsection",
 CellChangeTimes->{{3.9466361440093327`*^9, 
  3.946636162243128*^9}},ExpressionUUID->"92fd9b38-ed75-c041-a45b-\
a8ac5a25805a"],

Cell[CellGroupData[{

Cell["", "Item",
 CellChangeTimes->{
  3.94696279083897*^9},ExpressionUUID->"fe886783-654d-9e44-897d-e114eca62974"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edges", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"root", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"source", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"MyGraph", "[", 
    RowBox[{"edges", ",", "root", ",", "source", ",", "\[Beta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Z", "=", 
  RowBox[{"VertexAssignment", "[", 
   RowBox[{
    RowBox[{"g", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"\"\<system\>\"", "->", "\"\<LERW\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WickContraction", "[", "Z", "]"}], "/.", 
  RowBox[{"n", "->", 
   RowBox[{"-", "1"}]}]}]}], "Input",
 CellChangeTimes->{{3.9466361524980717`*^9, 3.9466361660704117`*^9}, {
   3.946636226940061*^9, 3.946636227503618*^9}, {3.946714280161281*^9, 
   3.9467143030354233`*^9}, {3.946714726521185*^9, 3.946714727480332*^9}, 
   3.946964310057476*^9, {3.9469762318025417`*^9, 3.946976244838171*^9}, 
   3.9470597041860924`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"970e6115-d263-2f45-8ec0-f397f46ab323"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "1"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "1"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"3", ",", 
        SubscriptBox["i", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}]]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "2"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"3", ",", 
        SubscriptBox["i", "2"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.946964315028026*^9, 3.9469643637092953`*^9, 3.946964622899795*^9, 
   3.946964803268638*^9, 3.946969719177323*^9, 3.946973751900759*^9, {
   3.946976215874979*^9, 3.946976245369524*^9}, 3.946976339940361*^9, 
   3.946976381922043*^9, {3.946976427428886*^9, 3.946976439630022*^9}, {
   3.94697651023422*^9, 3.946976524272131*^9}, 3.947059192346428*^9, 
   3.947059251378227*^9, 3.94705970451486*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"f6f79369-4fc8-2141-a6d6-90225ffc5f39"],

Cell[BoxData[
 RowBox[{"WickContraction", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{
       RowBox[{"\[Beta]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"\[Chi]", "[", 
        RowBox[{"1", ",", 
         SubscriptBox["i", "1"]}], "]"}], " ", 
       RowBox[{"\[Chi]s", "[", 
        RowBox[{"2", ",", 
         SubscriptBox["i", "1"]}], "]"}]}], 
      RowBox[{
       RowBox[{"\[Beta]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "+", 
       RowBox[{"\[Beta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"\[Beta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Chi]", "[", 
        RowBox[{"1", ",", 
         SubscriptBox["i", "1"]}], "]"}], " ", 
       RowBox[{"\[Chi]s", "[", 
        RowBox[{"3", ",", 
         SubscriptBox["i", "1"]}], "]"}]}], 
      RowBox[{
       RowBox[{"\[Beta]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "+", 
       RowBox[{"\[Beta]", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}]]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{
       RowBox[{"\[Beta]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"\[Chi]", "[", 
        RowBox[{"2", ",", 
         SubscriptBox["i", "2"]}], "]"}], " ", 
       RowBox[{"\[Chi]s", "[", 
        RowBox[{"1", ",", 
         SubscriptBox["i", "2"]}], "]"}]}], 
      RowBox[{
       RowBox[{"\[Beta]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "+", 
       RowBox[{"\[Beta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"\[Beta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"\[Chi]", "[", 
        RowBox[{"2", ",", 
         SubscriptBox["i", "2"]}], "]"}], " ", 
       RowBox[{"\[Chi]s", "[", 
        RowBox[{"3", ",", 
         SubscriptBox["i", "2"]}], "]"}]}], 
      RowBox[{
       RowBox[{"\[Beta]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "+", 
       RowBox[{"\[Beta]", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}]]}], ")"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.946964315028026*^9, 3.9469643637092953`*^9, 3.946964622899795*^9, 
   3.946964803268638*^9, 3.946969719177323*^9, 3.946973751900759*^9, {
   3.946976215874979*^9, 3.946976245369524*^9}, 3.946976339940361*^9, 
   3.946976381922043*^9, {3.946976427428886*^9, 3.946976439630022*^9}, {
   3.94697651023422*^9, 3.946976524272131*^9}, 3.947059192346428*^9, 
   3.947059251378227*^9, 3.9470597049698544`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"fa6a0a0c-c5e7-4242-a7cd-cd0567571573"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["More complex example CORRECT!!", "Item",
 CellChangeTimes->{{3.94671270298917*^9, 3.946712709442524*^9}, {
  3.9469644035167656`*^9, 
  3.946964406714443*^9}},ExpressionUUID->"132eb6e4-547d-cd46-8739-\
b3725de90bd8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"root", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"source", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"MyGraph", "[", 
    RowBox[{"edges", ",", "root", ",", "source", ",", "\[Beta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Z", "=", 
  RowBox[{"VertexAssignment", "[", 
   RowBox[{"g", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WickContraction", "[", "Z", "]"}], "/.", 
  RowBox[{"n", "->", 
   RowBox[{"-", "1"}]}]}]}], "Input",
 CellChangeTimes->{{3.946712721929367*^9, 3.9467127328672886`*^9}, {
   3.9467128142926846`*^9, 3.9467128849036503`*^9}, {3.9467129373957577`*^9, 
   3.9467129783097725`*^9}, {3.9467130765209084`*^9, 3.946713088684557*^9}, {
   3.946713147817171*^9, 3.9467131644611893`*^9}, {3.9467258019616127`*^9, 
   3.9467258020802956`*^9}, 3.946960687622963*^9, {3.94696380404932*^9, 
   3.9469638043455906`*^9}, {3.9469643310588303`*^9, 3.946964331215809*^9}, {
   3.9469646302185*^9, 3.946964630887501*^9}},
 CellLabel->
  "In[2355]:=",ExpressionUUID->"ddc4c380-612c-484b-b7a6-2e8c81c2b1ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", "[", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "1"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "1"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"3", ",", 
        SubscriptBox["i", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}]]}], "]"}], " ", 
  RowBox[{"V", "[", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "2"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "2"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"3", ",", 
        SubscriptBox["i", "2"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}]]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.9467257943001137`*^9, 3.9467258066315594`*^9}, 
   3.9467258525950146`*^9, 3.9469540483668346`*^9, 3.946960677932478*^9, 
   3.9469607134298553`*^9, 3.946962165886572*^9, 3.9469621992138176`*^9, 
   3.9469632556283207`*^9, {3.9469637767739563`*^9, 3.946963805088915*^9}, {
   3.9469643208020325`*^9, 3.946964332226551*^9}, 3.9469643690253525`*^9, 
   3.9469646313726845`*^9, 3.9469648071299324`*^9, 3.9469709584833736`*^9, {
   3.946973773305071*^9, 3.9469738219054775`*^9}, 3.9469738652853546`*^9, 
   3.94697625079723*^9, 3.9469763899543285`*^9, 3.9469764423244877`*^9, 
   3.946976526369898*^9, 3.947059262412487*^9},
 CellLabel->
  "Out[2360]=",ExpressionUUID->"530e5101-4cdb-ae4c-89bc-7ec47f791241"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], " ", 
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "3"}], "]"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[Beta]", "[", 
    RowBox[{"2", ",", "2"}], "]"}], 
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "+", 
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.9467257943001137`*^9, 3.9467258066315594`*^9}, 
   3.9467258525950146`*^9, 3.9469540483668346`*^9, 3.946960677932478*^9, 
   3.9469607134298553`*^9, 3.946962165886572*^9, 3.9469621992138176`*^9, 
   3.9469632556283207`*^9, {3.9469637767739563`*^9, 3.946963805088915*^9}, {
   3.9469643208020325`*^9, 3.946964332226551*^9}, 3.9469643690253525`*^9, 
   3.9469646313726845`*^9, 3.9469648071299324`*^9, 3.9469709584833736`*^9, {
   3.946973773305071*^9, 3.9469738219054775`*^9}, 3.9469738652853546`*^9, 
   3.94697625079723*^9, 3.9469763899543285`*^9, 3.9469764423244877`*^9, 
   3.946976526369898*^9, 3.94705926288377*^9},
 CellLabel->
  "Out[2361]=",ExpressionUUID->"9b51379b-1032-3d41-af99-462ad29ee284"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regular 2x2 lattice with absorption (i.e. source) at 4", "Item",
 CellChangeTimes->{{3.946964482529619*^9, 
  3.9469645472772503`*^9}},ExpressionUUID->"2c35eda2-cfce-d743-9a51-\
cf21e5efcfc7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"root", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"source", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"MyGraph", "[", 
    RowBox[{"edges", ",", "root", ",", "source", ",", "\[Beta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"VertexAssignment", "[", 
    RowBox[{"g", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WickContraction", "[", "Z", "]"}], "/.", 
  RowBox[{"n", "->", 
   RowBox[{"-", "1"}]}]}]}], "Input",
 CellChangeTimes->{{3.946964520437767*^9, 3.946964540244522*^9}, {
  3.946964652613867*^9, 3.9469646610269833`*^9}, {3.9469647184881744`*^9, 
  3.946964739802807*^9}},
 CellLabel->
  "In[2362]:=",ExpressionUUID->"83fe4051-e207-eb4a-bc69-c65d4b4921fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"V", "[", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "1"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "1"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"3", ",", 
        SubscriptBox["i", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}]]}], "]"}], " ", 
  RowBox[{"V", "[", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "2"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "4"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "4"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"2", ",", 
        SubscriptBox["i", "2"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"4", ",", 
        SubscriptBox["i", "2"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "4"}], "]"}]}]]}], "]"}], " ", 
  RowBox[{"V", "[", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"3", ",", "1"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"3", ",", 
        SubscriptBox["i", "3"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"1", ",", 
        SubscriptBox["i", "3"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"3", ",", "4"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"3", ",", "4"}], "]"}], " ", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"3", ",", 
        SubscriptBox["i", "3"]}], "]"}], " ", 
      RowBox[{"\[Chi]s", "[", 
       RowBox[{"4", ",", 
        SubscriptBox["i", "3"]}], "]"}]}], 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"3", ",", "4"}], "]"}]}]]}], "]"}]}]], "Output",
 CellChangeTimes->{3.946976553334646*^9, 3.947059272094919*^9},
 CellLabel->
  "Out[2367]=",ExpressionUUID->"35aafaff-a24b-2445-877b-6dffe5a843e5"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], " ", 
    RowBox[{"\[Beta]", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"2", ",", "4"}], "]"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Beta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"\[Beta]", "[", 
     RowBox[{"3", ",", "1"}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "+", 
      RowBox[{"\[Beta]", "[", 
       RowBox[{"3", ",", "4"}], "]"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.946976553334646*^9, 3.947059272570404*^9},
 CellLabel->
  "Out[2368]=",ExpressionUUID->"7e33eed3-fc77-5245-96d0-b9dd6ac1704e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Section",ExpressionUUID->"5115fb5e-76b6-b449-b950-db4c42c19aab"],

Cell[CellGroupData[{

Cell["\<\
We want to implement a partition function computing algorithm. LET\
\[CloseCurlyQuote]S TRY WITH THE STANDARD PRODUCT (i.e. commutation)\
\>", "Item",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.939118617351705*^9, 3.939118617351705*^9}, {
  3.939119745052809*^9, 3.9391197498140736`*^9}, {3.939705397376882*^9, 
  3.939705397378799*^9}},ExpressionUUID->"79ff84b5-8f52-354a-8abb-\
0141ba4fffee"],

Cell["\<\
Throughout the code we use the Zeta function to replace positive parameters \
to avoid that Mathematica does weird stuff\
\>", "Subsubitem",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.939118617351705*^9, 3.939118617351705*^9}, {
  3.939119745052809*^9, 3.9391197498140736`*^9}, {3.9397053999409885`*^9, 
  3.9397054657660007`*^9}},ExpressionUUID->"539045f2-e12e-f740-a199-\
c241b5b317fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["After many trials, we arrived at the following conclusions:", "Item",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.9391186186631966`*^9, 
  3.939118636904541*^9}},ExpressionUUID->"31116618-da27-1d4a-85a6-\
754212ab01f6"],

Cell[TextData[{
 "1) In order to get the \[OpenCurlyDoubleQuote]loop structure\
\[CloseCurlyDoubleQuote], we simply need the terms with the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", "..."], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f60a96b9-7a27-f24f-a197-56bef9a57da0"],
 ". "
}], "Subitem",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.9391186186631966`*^9, 
  3.939118683381716*^9}},ExpressionUUID->"fedbeb3d-3112-1f4b-9df1-\
67ec93f26a6a"],

Cell["\<\
2) We do not need to explicate all the flavour indices: we just need to use \
different indices for each term, then use the Kronecker \[Delta] and then sum \
over them with the classical rules. When one obtains \[Delta][a,a] then it\
\[CloseCurlyQuote]s equal to n. This number represents the number of fermions \
minus the number of bosons, and it is the \[OpenCurlyDoubleQuote]weight\
\[CloseCurlyDoubleQuote] of each loop. Kay says that we should substitute it \
with n->-2, but it seems that n->-1 is the one that works.\
\>", "Subitem",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.9391186186631966`*^9, 
  3.939118880938663*^9}},ExpressionUUID->"07b41a31-a66d-b94f-8038-\
5ec3cb977be5"],

Cell[CellGroupData[{

Cell["\<\
3) There is no need for any fancy commutation relation, berezinIntegral or \
wickContraction: simply use the nihilpotency of the fields to get rid of the \
\[OpenCurlyDoubleQuote]wrong\[CloseCurlyDoubleQuote] terms, then substitute:\
\>", "Subitem",
 CellChangeTimes->{{3.9386874808455143`*^9, 3.938687508626948*^9}, {
  3.938838570151605*^9, 3.938838573335644*^9}, {3.938846185850879*^9, 
  3.938846194421831*^9}, {3.9391186186631966`*^9, 3.9391189617676163`*^9}, {
  3.939119000787983*^9, 
  3.939119001358324*^9}},ExpressionUUID->"2aa48082-2775-ef43-b8df-\
87e820637338"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "nihilpotency", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nihilpotency", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"A_", "[", 
      RowBox[{"x_", ",", "i_"}], "]"}], "*", 
     RowBox[{"A_", "[", 
      RowBox[{"x_", ",", "i_"}], "]"}]}], "\[Rule]", "0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.938831202037205*^9, 3.938831218346205*^9}, {
  3.938835183007219*^9, 3.938835184620882*^9}, {3.938835289850413*^9, 
  3.9388352905285378`*^9}, {3.9388384317914333`*^9, 3.938838439336839*^9}, {
  3.9388453483033237`*^9, 3.938845365108453*^9}, {3.938846216950609*^9, 
  3.938846244127346*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"26d07459-8f8c-0b4c-98da-5920d2d2e881"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "contraction", "]"}], "\[IndentingNewLine]", 
 RowBox[{"contraction", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "a_"}], "]"}], "*", 
      RowBox[{"\[Phi]s", "[", 
       RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
      "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "a_"}], "]"}], "*", 
      RowBox[{"\[Phi]s", "[", 
       RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939119028738727*^9, 3.9391190640011864`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"0b794d01-a48c-684b-bfab-b10bb6379e2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], " ", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"x_", ",", "b_"}], "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"D\[Delta]", "[", "x", "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"a", ",", "b", ",", "x"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], " ", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9391197936034985`*^9, 3.939705697164062*^9, 
  3.9418704848960114`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"2dec9736-1918-d841-b109-feeace776901"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4) Finally, simplify the \[Delta]\[CloseCurlyQuote]s and substitute \
everything", "Subitem",
 CellChangeTimes->{{3.939119034764269*^9, 3.939119036436605*^9}, {
  3.9391191024194355`*^9, 
  3.9391191451458263`*^9}},ExpressionUUID->"b171f651-1cd1-c14b-a825-\
4622ed538a0f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalSigma]\[Delta]rule", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]\[Delta]rule", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"b_", ",", "a_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"c_", ",", "b_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"c", ",", "a"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"b_", ",", "c_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "c"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "a", "]"}]}], ")"}]}], ":>", "n"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9391131881501617`*^9, 3.939113283186725*^9}, {
  3.939113389840746*^9, 3.939113402757696*^9}, {3.939113449313545*^9, 
  3.939113458780845*^9}, {3.939113616347803*^9, 3.939113621073095*^9}, {
  3.939114336776186*^9, 3.939114336837799*^9}, {3.939114949323351*^9, 
  3.939114951038183*^9}, {3.939114988558977*^9, 3.939114988909434*^9}, {
  3.939115028918001*^9, 3.93911504717482*^9}, {3.939115105664192*^9, 
  3.939115141306975*^9}, {3.939115232438454*^9, 3.939115233263678*^9}, {
  3.939122214889879*^9, 3.939122250735031*^9}, {3.939179739198454*^9, 
  3.939179743863943*^9}, {3.93987523112001*^9, 3.9398752503305664`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"f230b126-0c88-5d45-b8b1-6872d54b7e27"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalSigma]\[Delta]ruleMod", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]\[Delta]ruleMod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"b_", ",", "a_", ",", "x_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"c_", ",", "b_", ",", "y_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"c", ",", "a", ",", "y"}], "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"y", ",", "x"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_", ",", "x_"}], "]"}], 
        RowBox[{"\[Delta]", "[", 
         RowBox[{"b_", ",", "c_", ",", "y_"}], "]"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "b", "]"}]}], ")"}]}], ":>", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "c", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_", ",", "x_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"NumericQ", "[", "a", "]"}]}], ")"}]}], ":>", "n"}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9391131881501617`*^9, 3.939113283186725*^9}, {
  3.939113389840746*^9, 3.939113402757696*^9}, {3.939113449313545*^9, 
  3.939113458780845*^9}, {3.939113616347803*^9, 3.939113621073095*^9}, {
  3.939114336776186*^9, 3.939114336837799*^9}, {3.939114949323351*^9, 
  3.939114951038183*^9}, {3.939114988558977*^9, 3.939114988909434*^9}, {
  3.939115028918001*^9, 3.93911504717482*^9}, {3.939115105664192*^9, 
  3.939115141306975*^9}, {3.939115232438454*^9, 3.939115233263678*^9}, {
  3.939122214889879*^9, 3.939122250735031*^9}, {3.939179739198454*^9, 
  3.939179743863943*^9}, {3.939893370701828*^9, 3.9398933716011868`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"8f0c5aa7-f172-2244-95d1-2a233962f71a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalSigma]D\[Delta]ruleMod", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalSigma]D\[Delta]ruleMod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a_", "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "b_", "]"}]}], "->", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"a", ",", "b"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "b", "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "b_", "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"a", ",", "b"}], "]"}], 
       RowBox[{"D\[Delta]", "[", 
        RowBox[{"b", ",", "c"}], "]"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.939113324370577*^9, 3.939113327528763*^9}, {
   3.93911364045294*^9, 3.93911366377297*^9}, {3.939113725836361*^9, 
   3.939113726517611*^9}, {3.939113804615553*^9, 3.939113807647869*^9}, 
   3.93911384980804*^9, 3.939114044091543*^9, {3.9391145298378677`*^9, 
   3.939114533230047*^9}, {3.939114617245337*^9, 3.939114668684122*^9}, 
   3.939115384228779*^9, 3.9391154494889507`*^9, {3.9391155056920605`*^9, 
   3.9391155185301228`*^9}, {3.9391155806848583`*^9, 3.939115583388817*^9}, {
   3.93911567001511*^9, 3.9391157025436306`*^9}, {3.939115930651041*^9, 
   3.9391159459624786`*^9}, {3.939116016302918*^9, 3.9391160167004414`*^9}, {
   3.9391162294789505`*^9, 3.939116256555729*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"66b2709d-c021-1a4c-9429-5dbd0a0561ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"n", "->", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{
     RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.939119245757071*^9, 3.93911927789295*^9}, {
  3.939120193286455*^9, 3.939120196349069*^9}, {3.939179825116091*^9, 
  3.939179826020595*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"be0fdbc9-33b4-6a40-aaca-9b38b7bda553"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "\[Rule]", "1"}], ",", 
   RowBox[{"1", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{3.94187048494281*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"cf6245b3-ad00-7345-a449-6bbb07266ba8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
4.bis) If there are external fields (e.g. in correlators) then we do not want \
to sum over their indices. Instead we want to keep only the terms which yield \
a non-vanishing \
\>", "Subitem",
 CellChangeTimes->{{3.939179827514393*^9, 
  3.939179920843826*^9}},ExpressionUUID->"c0e96f75-58d7-5146-b483-\
878f45e80c15"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[Delta]ruleExternalMod", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]ruleExternalMod", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_", ",", "x_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], ":>", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_", ",", "x_"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"a", "==", "b"}]}], ")"}]}], ":>", "0"}]}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.939179947628132*^9, 3.939180011782891*^9}, {
  3.939879903456558*^9, 3.939879906649355*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"261adeb5-dab9-2249-94b2-d22287175407"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[Delta]ruleExternal", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]ruleExternal", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a_", ",", "a_"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], ":>", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Delta]", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"NumericQ", "[", "a", "]"}], ")"}]}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"a", "==", "b"}]}], ")"}]}], ":>", "0"}]}], " ", "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.939179947628132*^9, 3.939180011782891*^9}, {
  3.939879910309513*^9, 3.9398799137113533`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"5bae1f8b-782e-2145-b382-a133483fd60b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["E.g.1) Easiest case of all: simply 2 vertices: CORRECT!", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.939119918481055*^9}, {
  3.9391202242272396`*^9, 
  3.939120228496233*^9}},ExpressionUUID->"9ae37851-07b4-ee45-b599-\
6a9f52e2c880"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "x"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"y", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"x", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "y"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "7", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"x", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"y", ",", "j"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", 
       SubscriptBox["\[Beta]", "xy"]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", 
       SubscriptBox["r", "x"]}], ",", "  ", 
      RowBox[{
       RowBox[{"Zeta", "[", "7", "]"}], "->", 
       SubscriptBox["\[Beta]", "yx"]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "9", "]"}], "->", 
       SubscriptBox["r", "y"]}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
  3.939120143674591*^9, 3.9391202074098396`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"c20a91b7-8a7e-ac48-981e-7ce77c901821"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"D\[Delta]", "[", "x", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"y", ",", "x"}], "]"}], " ", 
    RowBox[{"Zeta", "[", "5", "]"}], " ", 
    RowBox[{"Zeta", "[", "7", "]"}]}], 
   RowBox[{
    RowBox[{"Zeta", "[", "3", "]"}], " ", 
    RowBox[{"Zeta", "[", "9", "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.9391222591515617`*^9, 
   3.9397251427635536`*^9, 3.941870484990116*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"7b2b3c5c-2a31-c64c-8c44-73962e1f4c40"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"D\[Delta]", "[", "x", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"y", ",", "x"}], "]"}], " ", 
    SubscriptBox["\[Beta]", "xy"], " ", 
    SubscriptBox["\[Beta]", "yx"]}], 
   RowBox[{
    SubscriptBox["r", "x"], " ", 
    SubscriptBox["r", "y"]}]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.9391222591515617`*^9, 
   3.9397251427635536`*^9, 3.941870484990116*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"3858ec54-f4d7-c343-90b9-95893e9e1095"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["\[Beta]", "xy"], " ", 
    SubscriptBox["\[Beta]", "yx"]}], 
   RowBox[{
    SubscriptBox["r", "x"], " ", 
    SubscriptBox["r", "y"]}]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.9391222591515617`*^9, 
   3.9397251427635536`*^9, 3.941870484990116*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"182da0eb-aca8-5a43-a25d-14c1d2974b17"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.2.1) Slightly more complicated: 3 vertices a,b,c. Starts from a and can \
go directly to c or passing through b. At b there can be a self-loop. Total \
absorption at c. CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.939119918481055*^9}, {
   3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
   3.939120370520834*^9}, {3.939120416186205*^9, 3.939120423254008*^9}, {
   3.93912076689037*^9, 3.939120790737067*^9}, {3.939811020259966*^9, 
   3.939811020467525*^9}, {3.9398110621980553`*^9, 3.939811080516915*^9}, 
   3.939875272542576*^9},ExpressionUUID->"ae10d59d-ec9c-0a44-bf94-\
a5d9839ac1c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "a"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"c", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"a", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "7", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"b", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"a", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "b"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "9", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"c", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "15", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"b", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", 
       RowBox[{"\[Beta]", "''"}]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", 
       SubscriptBox["r", "a"]}], ",", "  ", 
      RowBox[{
       RowBox[{"Zeta", "[", "7", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "9", "]"}], "->", 
       RowBox[{"\[Beta]", "'''"}]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "13", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "11", "]"}], "->", 
       SubscriptBox["r", "b"]}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "15", "]"}], "->", 
       RowBox[{"\[Beta]", "'"}]}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox[
     SuperscriptBox["Z", "d"], "abc"], "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
  3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
  3.9391204070097237`*^9}, {3.939120437494154*^9, 3.939120614655537*^9}, {
  3.939122027308365*^9, 3.939122030869249*^9}, {3.939811087533544*^9, 
  3.9398111545219975`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"d022a4c7-ba46-ca4f-93a4-78118a84b278"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"D\[Delta]", "[", "b", "]"}], " ", 
    RowBox[{"Zeta", "[", "15", "]"}]}], 
   RowBox[{"Zeta", "[", "11", "]"}]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, 3.939122031355747*^9, 3.939122269444992*^9, 
   3.939180044381092*^9, 3.939810688202257*^9, 3.9398110883265495`*^9, {
   3.939811127133217*^9, 3.939811155455065*^9}, 3.9418704850224667`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"2d55c2ea-329c-d84f-a373-9095c840de79"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"D\[Delta]", "[", "b", "]"}], " ", 
    SuperscriptBox["\[Beta]", "\[Prime]",
     MultilineFunction->None]}], 
   SubscriptBox["r", "b"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, 3.939122031355747*^9, 3.939122269444992*^9, 
   3.939180044381092*^9, 3.939810688202257*^9, 3.9398110883265495`*^9, {
   3.939811127133217*^9, 3.939811155455065*^9}, 3.9418704850224667`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"048ce62e-ee2a-944c-aef8-e041ea7a1204"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   SuperscriptBox["\[Beta]", "\[Prime]",
    MultilineFunction->None], 
   SubscriptBox["r", "b"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, 3.939122031355747*^9, 3.939122269444992*^9, 
   3.939180044381092*^9, 3.939810688202257*^9, 3.9398110883265495`*^9, {
   3.939811127133217*^9, 3.939811155455065*^9}, 3.9418704850374756`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"9d3e784a-0700-f945-b7da-cbfa3fb9aa03"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.2.2) Slightly more complicated: 3 vertices a,b,c. Starts from a and can \
go directly to c or passing through b. At b there can be a self-loop and it \
could also come back to a. Total absorption at c. CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.939119918481055*^9}, {
  3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
  3.939120370520834*^9}, {3.939120416186205*^9, 3.9391204232540083`*^9}, {
  3.93912076689037*^9, 3.9391207907370667`*^9}, {3.939811020259966*^9, 
  3.9398110204675255`*^9}, {3.939811059087229*^9, 
  3.939811059311037*^9}},ExpressionUUID->"5b9fd806-f94c-5a44-954b-\
ab372ccb3a73"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "a"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"c", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"a", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "7", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"b", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"a", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "b"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "9", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"c", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "13", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"a", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "15", "]"}], "/", 
          RowBox[{"Zeta", "[", "11", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"b", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"b", ",", "j"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]rule"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "->", 
        RowBox[{"\[Beta]", "''"}]}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "3", "]"}], "->", 
        SubscriptBox["r", "a"]}], ",", "  ", 
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "9", "]"}], "->", 
        RowBox[{"\[Beta]", "'''"}]}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "13", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "11", "]"}], "->", 
        SubscriptBox["r", "b"]}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "15", "]"}], "->", 
        RowBox[{"\[Beta]", "'"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox[
     SuperscriptBox["Z", "u"], "abc"], "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], "}"}]}]}]}]}]], "Input",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
   3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
   3.9391204070097237`*^9}, {3.939120437494154*^9, 3.939120614655537*^9}, {
   3.939122027308365*^9, 3.939122030869249*^9}, {3.939811161761045*^9, 
   3.939811172215084*^9}, {3.939875279854307*^9, 3.939875294252804*^9}, 
   3.939876008854748*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"30fde334-9436-4d41-a62c-741e1f70b2c9"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   SuperscriptBox["\[Beta]", "2"], 
   RowBox[{
    SubscriptBox["r", "a"], " ", 
    SubscriptBox["r", "b"]}]], "-", 
  FractionBox[
   SuperscriptBox["\[Beta]", "\[Prime]",
    MultilineFunction->None], 
   SubscriptBox["r", "b"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, 3.939122031355747*^9, 3.939122269444992*^9, 
   3.939180044381092*^9, 3.939810688202257*^9, {3.939811163186458*^9, 
   3.939811172563963*^9}, 3.939875306290943*^9, 3.939876176198339*^9, 
   3.941870485068735*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"d3179959-a76b-ff41-8e07-8567263f569f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]s", "->", "1"}], ",", " ", 
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"\[Beta]p", "->", "1"}], ",", 
    RowBox[{
     SubscriptBox["r", "b"], "->", "4"}], ",", 
    RowBox[{
     SubscriptBox["r", "a"], "->", "3"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9391206539414234`*^9, 3.939120758139254*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"89dcc36f-f472-bd44-9dc5-1cf21f4541e3"],

Cell[BoxData[
 RowBox[{
  FractionBox["11", "12"], "-", 
  FractionBox[
   RowBox[{"0", "&"}], "4"]}]], "Output",
 CellChangeTimes->{{3.939120740966526*^9, 3.939120758678023*^9}, 
   3.941870485084873*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"d108f653-d0b9-e745-a94e-5d0fcc2efced"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.3.0) 2x2 square lattice: everything has the same weight and every vertex \
is connected both forward and backward. CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.939119918481055*^9}, {
   3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
   3.939120370520834*^9}, {3.939120416186205*^9, 3.9391204232540083`*^9}, {
   3.93912076689037*^9, 3.9391207907370667`*^9}, {3.939120865256918*^9, 
   3.939120924967476*^9}, 3.9391209911409397`*^9, {3.93989334406592*^9, 
   3.939893345373722*^9}},ExpressionUUID->"95f6d0ff-e871-a248-8411-\
f5b605eff070"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "1"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "l"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "l"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "l"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "l"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
  3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
  3.9391204070097237`*^9}, {3.939120437494154*^9, 3.939120614655537*^9}, {
  3.9391209294803505`*^9, 3.939120961324808*^9}, {3.9391210030295715`*^9, 
  3.939121033656*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"43e26709-a0ee-fb4d-9581-f1ea14cca791"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "3", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"0", ",", "2"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"0", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "3", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "3", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "4"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.941870485132805*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"cebe269d-f262-dd4e-8d42-ac46909fe95d"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.941870485132805*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"b9e8418f-cb6a-ba4a-bb4c-c4c273f53cf4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.939121042832838*^9, 3.9391210506901917`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"69a43f82-ca57-1441-80bf-33e24774125a"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.939121051194697*^9, 3.941870485163864*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"35a73865-2f28-d240-ae64-9db64a817d6b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.3.1) 2x2 square lattice: same as before but 1 absorbs everything. \
CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.9391199184810543`*^9}, {
   3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
   3.939120370520834*^9}, {3.939120416186205*^9, 3.9391204232540092`*^9}, {
   3.9391207668903694`*^9, 3.9391207907370663`*^9}, {3.939120865256918*^9, 
   3.939120924967476*^9}, 3.9391209911409397`*^9, {3.9391210710001545`*^9, 
   3.9391211032751427`*^9}},ExpressionUUID->"2cf23a1f-8588-4440-9337-\
ec3b1e737975"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
   3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
   3.9391204070097237`*^9}, {3.939120437494154*^9, 3.939120614655537*^9}, {
   3.9391209294803505`*^9, 3.939120961324808*^9}, {3.9391210030295715`*^9, 
   3.939121033656*^9}, {3.939121107705538*^9, 3.93912110889267*^9}, {
   3.939121165527727*^9, 3.9391211739835625`*^9}, 3.939121277477867*^9, 
   3.939121322693334*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"d8a11bcc-572e-6b47-b65f-6f9b7cfa1d91"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.939121109982284*^9, 3.9391211757200413`*^9, {3.9391212785213194`*^9, 
   3.939121285992798*^9}, 3.9391213232578297`*^9, 3.941870485195568*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"e7e38040-d029-6341-aa06-457c363255a0"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.939121109982284*^9, 3.9391211757200413`*^9, {3.9391212785213194`*^9, 
   3.939121285992798*^9}, 3.9391213232578297`*^9, 3.941870485195568*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"bd53ef60-bd60-d748-8ccd-9e84a44403b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.939121042832838*^9, 3.9391210506901917`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"306f2050-30a1-d243-a8e8-dfe2d161a62c"],

Cell[BoxData[
 FractionBox["1", "2"]], "Output",
 CellChangeTimes->{3.939121051194697*^9, 3.939121117498598*^9, 
  3.939121192051903*^9, 3.939121281887991*^9, 3.9391213256148567`*^9, 
  3.941870485227394*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"e135ef2a-d604-864d-8491-6b9ff38a9f27"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
E.g.3.2) 2x2 square lattice: same as before but 1 absorbs only from 3. \
CORRECT!!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939119865856848*^9, 3.9391199184810543`*^9}, {
   3.9391202242272396`*^9, 3.93912026800753*^9}, {3.939120316132612*^9, 
   3.939120370520834*^9}, {3.939120416186205*^9, 3.9391204232540092`*^9}, {
   3.9391207668903694`*^9, 3.9391207907370663`*^9}, {3.939120865256918*^9, 
   3.939120924967476*^9}, 3.9391209911409397`*^9, {3.9391210710001545`*^9, 
   3.939121152060135*^9}},ExpressionUUID->"61c94159-63f8-5341-9856-\
d93ac2d3bd47"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "1"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "l"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "l"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "->", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{
       RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
     "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.939120033231417*^9, 3.93912009671538*^9}, {
   3.939120143674591*^9, 3.9391202074098396`*^9}, {3.939120375509392*^9, 
   3.9391204070097237`*^9}, {3.939120437494154*^9, 3.939120614655537*^9}, {
   3.9391209294803505`*^9, 3.939120961324808*^9}, {3.9391210030295715`*^9, 
   3.939121033656*^9}, {3.939121107705538*^9, 3.93912110889267*^9}, 
   3.939121275073435*^9, {3.939121342064612*^9, 3.939121368066996*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"d6b250c9-9aa9-584e-9b42-a8d8917fb56a"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "2"], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "2", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "4"]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    SuperscriptBox["\[Beta]", "4"], " ", 
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}], 
   SuperscriptBox["r", "4"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.939121109982284*^9, {3.939121331808187*^9, 3.9391213688229685`*^9}, 
   3.941870485258871*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"72534e13-1027-0e4a-bf6b-cc7e58388d07"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{{3.939120091302237*^9, 3.939120097259613*^9}, 
   3.9391201763334904`*^9, 3.939120207932469*^9, 3.939120615844591*^9, 
   3.93912075236673*^9, {3.939121011448004*^9, 3.939121034429884*^9}, 
   3.939121109982284*^9, {3.939121331808187*^9, 3.9391213688229685`*^9}, 
   3.941870485258871*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"9eac7e62-08dc-b840-99b5-319c52a447c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.939121042832838*^9, 3.9391210506901917`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"32d902ce-f1ff-6347-ab19-985341a9cdde"],

Cell[BoxData[
 FractionBox["1", "4"]], "Output",
 CellChangeTimes->{
  3.939121051194697*^9, 3.939121117498598*^9, {3.93912135486594*^9, 
   3.939121372034336*^9}, 3.941870485290043*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"000e7fd5-579a-4941-89ee-17b024495381"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We have checked many partition functions. Let\[CloseCurlyQuote]s now check \
the observable U(a,b,c)=sum of the probabilities of all LERWs going from a to \
c and passing through b. \t\t\tCORRECT!!!!\
\>", "Item",
 CellChangeTimes->{{3.9391214313720913`*^9, 3.939121522013119*^9}, {
  3.939181417328535*^9, 
  3.9391814215206604`*^9}},ExpressionUUID->"09f88d79-ca2e-c945-aa7e-\
efb0e4f7fe04"],

Cell[CellGroupData[{

Cell["\<\
e.g.U1.1)Let\[CloseCurlyQuote]s begin with the most simple non-trivial \
example: that with the 3 vertices a b c with self-loop at b and total \
absorption at c. We then want to get the probability of a LERW passing \
through b. The observable is given by the correlator of 4 fields with fixed \
flavour indices.       CORRECT!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.9391215261224346`*^9, 3.939121657260519*^9}, {
  3.9391216926246853`*^9, 3.939121747220539*^9}, {3.939181426268709*^9, 
  3.9391814325884647`*^9}, {3.939181477306015*^9, 3.939181483536522*^9}, {
  3.9398114595759296`*^9, 
  3.9398114597786255`*^9}},ExpressionUUID->"0cd69e85-42c3-234a-8755-\
cfed69381d90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"c", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"b", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"b", ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"a", ",", "1"}], "]"}], 
    RowBox[{"(*", 
     RowBox[{"From", " ", "a"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"c", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"a", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"b", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"a", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "b"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "9", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"c", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "13", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"a", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "15", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"b", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", 
      RowBox[{"\[Beta]", "''"}]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", 
      SubscriptBox["r", "a"]}], ",", "  ", 
     RowBox[{
      RowBox[{"Zeta", "[", "7", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "9", "]"}], "->", 
      RowBox[{"\[Beta]", "'''"}]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "13", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "11", "]"}], "->", 
      SubscriptBox["r", "b"]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "15", "]"}], "->", 
      RowBox[{"\[Beta]", "'"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Now", " ", "normalize", " ", "it", " ", "with", " ", 
    RowBox[{"1", "/", "Z"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", 
   SubscriptBox[
    SuperscriptBox["Z", "u"], "abc"]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["r", "b"], "->", 
      RowBox[{"\[Lambda]", "+", "\[Beta]", "+", 
       RowBox[{"\[Beta]", "'"}], "+", 
       RowBox[{"\[Beta]", "'''"}]}]}], ",", 
     RowBox[{
      SubscriptBox["r", "a"], "->", 
      RowBox[{"\[Lambda]", "+", "\[Beta]", "+", 
       RowBox[{"\[Beta]", "''"}]}]}]}], "}"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]", "''"}], "->", "1"}], ",", " ", 
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{
     RowBox[{"\[Beta]", "'"}], "->", "1"}], ",", 
    RowBox[{
     RowBox[{"\[Beta]", "'''"}], "->", "1"}], ",", 
    RowBox[{"\[Lambda]", "->", "1"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.9391217749380493`*^9, 3.939121802200369*^9}, {
  3.939122126101866*^9, 3.939122126798973*^9}, {3.9391229724643497`*^9, 
  3.939122976263193*^9}, {3.9391230267883625`*^9, 3.939123028397297*^9}, {
  3.9391233265683193`*^9, 3.939123429688146*^9}, {3.939123505859028*^9, 
  3.939123571761419*^9}, {3.939180025195973*^9, 3.939180029254198*^9}, {
  3.939180183639393*^9, 3.939180284469937*^9}, {3.939181463243608*^9, 
  3.939181463982991*^9}, {3.939811208029347*^9, 3.9398112087521095`*^9}, {
  3.939811240249197*^9, 3.939811278681814*^9}, {3.939811665599205*^9, 
  3.9398116680987797`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"fb48d549-3742-d049-a247-e0780461886a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{"1", ",", "3", ",", "b"}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"3", ",", "1", ",", "c"}], "]"}], " ", 
    SuperscriptBox["\[Beta]", "\[Prime]",
     MultilineFunction->None], " ", 
    SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
     MultilineFunction->None]}], 
   RowBox[{
    SubscriptBox["r", "a"], " ", 
    SubscriptBox["r", "b"]}]], "+", 
  FractionBox[
   RowBox[{"\[Beta]", " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"1", ",", "1", ",", "b"}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"3", ",", "3", ",", "c"}], "]"}], " ", 
    SuperscriptBox["\[Beta]", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None]}], 
   RowBox[{
    SubscriptBox["r", "a"], " ", 
    SubscriptBox["r", "b"]}]]}]], "Output",
 CellChangeTimes->{
  3.939121803281517*^9, 3.939121871090769*^9, 3.939122063555956*^9, 
   3.9391221279823*^9, 3.9391222775278645`*^9, 3.9391225844356174`*^9, 
   3.939122976743147*^9, 3.939123028948368*^9, {3.9391233338199463`*^9, 
   3.939123381258713*^9}, {3.939123417817821*^9, 3.93912343074988*^9}, {
   3.939123507943138*^9, 3.939123572132443*^9}, {3.939178967389904*^9, 
   3.939178987297457*^9}, 3.939179752031389*^9, 3.939179796151598*^9, {
   3.939180030726992*^9, 3.9391800481687355`*^9}, 3.939180140375365*^9, {
   3.9391802690696545`*^9, 3.939180284818241*^9}, {3.939181445443329*^9, 
   3.939181464332394*^9}, 3.939811280195984*^9, 3.9398116685967712`*^9, 
   3.941870485322628*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"202b769b-53e4-bf46-a341-94afb7ce7767"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      RowBox[{"1", ",", "3", ",", "b"}], "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"3", ",", "1", ",", "c"}], "]"}], " ", 
     SuperscriptBox["\[Beta]", "\[Prime]",
      MultilineFunction->None], " ", 
     SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
      MultilineFunction->None]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"1", ",", "1", ",", "b"}], "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"3", ",", "3", ",", "c"}], "]"}], " ", 
     SuperscriptBox["\[Beta]", 
      TagBox[
       RowBox[{"(", "3", ")"}],
       Derivative],
      MultilineFunction->None]}]}], 
   RowBox[{
    SuperscriptBox["\[Beta]", "2"], "+", 
    RowBox[{
     SubscriptBox["r", "a"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["r", "b"]}], "+", 
       SuperscriptBox["\[Beta]", "\[Prime]",
        MultilineFunction->None]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.939121803281517*^9, 3.939121871090769*^9, 3.939122063555956*^9, 
   3.9391221279823*^9, 3.9391222775278645`*^9, 3.9391225844356174`*^9, 
   3.939122976743147*^9, 3.939123028948368*^9, {3.9391233338199463`*^9, 
   3.939123381258713*^9}, {3.939123417817821*^9, 3.93912343074988*^9}, {
   3.939123507943138*^9, 3.939123572132443*^9}, {3.939178967389904*^9, 
   3.939178987297457*^9}, 3.939179752031389*^9, 3.939179796151598*^9, {
   3.939180030726992*^9, 3.9391800481687355`*^9}, 3.939180140375365*^9, {
   3.9391802690696545`*^9, 3.939180284818241*^9}, {3.939181445443329*^9, 
   3.939181464332394*^9}, 3.939811280195984*^9, 3.9398116685967712`*^9, 
   3.941870485337734*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"a6fa2be9-5e1d-e842-8814-f24431ed6ca7"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]", "[", 
     RowBox[{"1", ",", "3", ",", "b"}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"3", ",", "1", ",", "c"}], "]"}], " ", 
    SuperscriptBox["\[Beta]", "\[Prime]",
     MultilineFunction->None], " ", 
    SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"1", ",", "1", ",", "b"}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"3", ",", "3", ",", "c"}], "]"}], " ", 
    SuperscriptBox["\[Beta]", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None]}]}], 
  RowBox[{
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "\[Beta]"}], "+", "\[Lambda]"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Beta]", "+", "\[Lambda]"}], ")"}], " ", 
    SuperscriptBox["\[Beta]", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None]}], "+", 
   RowBox[{
    SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
     MultilineFunction->None], " ", 
    RowBox[{"(", 
     RowBox[{"\[Beta]", "+", "\[Lambda]", "+", 
      SuperscriptBox["\[Beta]", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.939121803281517*^9, 3.939121871090769*^9, 3.939122063555956*^9, 
   3.9391221279823*^9, 3.9391222775278645`*^9, 3.9391225844356174`*^9, 
   3.939122976743147*^9, 3.939123028948368*^9, {3.9391233338199463`*^9, 
   3.939123381258713*^9}, {3.939123417817821*^9, 3.93912343074988*^9}, {
   3.939123507943138*^9, 3.939123572132443*^9}, {3.939178967389904*^9, 
   3.939178987297457*^9}, 3.939179752031389*^9, 3.939179796151598*^9, {
   3.939180030726992*^9, 3.9391800481687355`*^9}, 3.939180140375365*^9, {
   3.9391802690696545`*^9, 3.939180284818241*^9}, {3.939181445443329*^9, 
   3.939181464332394*^9}, 3.939811280195984*^9, 3.9398116685967712`*^9, 
   3.9418704853689976`*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"43846a77-30c9-c741-ae22-665b3b5f4fd1"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      RowBox[{"1", ",", "3", ",", "b"}], "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"3", ",", "1", ",", "c"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      RowBox[{"1", ",", "1", ",", "b"}], "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"3", ",", "3", ",", "c"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.939121803281517*^9, 3.939121871090769*^9, 3.939122063555956*^9, 
   3.9391221279823*^9, 3.9391222775278645`*^9, 3.9391225844356174`*^9, 
   3.939122976743147*^9, 3.939123028948368*^9, {3.9391233338199463`*^9, 
   3.939123381258713*^9}, {3.939123417817821*^9, 3.93912343074988*^9}, {
   3.939123507943138*^9, 3.939123572132443*^9}, {3.939178967389904*^9, 
   3.939178987297457*^9}, 3.939179752031389*^9, 3.939179796151598*^9, {
   3.939180030726992*^9, 3.9391800481687355`*^9}, 3.939180140375365*^9, {
   3.9391802690696545`*^9, 3.939180284818241*^9}, {3.939181445443329*^9, 
   3.939181464332394*^9}, 3.939811280195984*^9, 3.9398116685967712`*^9, 
   3.9418704853689976`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"3457024b-3244-9541-8f4b-ccab5dd2f033"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
e.g. U1.2) Now let\[CloseCurlyQuote]s compute the one on the left. In order \
to do so we need a little trick: since we need a point through which the path \
goes, we add a fictitious extra vertex between a and c, which we\
\[CloseCurlyQuote]ll call b\[CloseCurlyQuote]. \t\tCORRECT!!!!\
\>", "Subitem",
 CellChangeTimes->{{3.939181468891344*^9, 3.939181573412277*^9}, {
  3.939181977537741*^9, 3.939181985725363*^9}, {3.9398114621845856`*^9, 
  3.9398114622435513`*^9}},ExpressionUUID->"adacadf2-0bd8-e545-9de2-\
540c674467a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"c", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"a", ",", "1"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "a"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"a", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"b", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"a", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "b"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "9", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"c", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "13", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"a", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "15", "]"}], "/", 
        RowBox[{"Zeta", "[", "11", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"b", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"b", ",", "j"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"c", ",", "k"}], "]"}], 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "k"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "a_"}], "]"}], "*", 
      RowBox[{"\[Phi]s", "[", 
       RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
     RowBox[{"(", 
      RowBox[{"!", 
       RowBox[{"NumericQ", "[", 
        RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]rule"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", 
      RowBox[{"\[Beta]", "''"}]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", 
      SubscriptBox["r", "a"]}], ",", "  ", 
     RowBox[{
      RowBox[{"Zeta", "[", "7", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "9", "]"}], "->", 
      RowBox[{"\[Beta]", "'''"}]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "13", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "11", "]"}], "->", 
      SubscriptBox["r", "b"]}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "15", "]"}], "->", 
      RowBox[{"\[Beta]", "'"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Now", " ", "normalize", " ", "it", " ", "with", " ", 
    RowBox[{"1", "/", "Z"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", 
   SubscriptBox[
    SuperscriptBox["Z", "u"], "abc"]}], "//", "FullSimplify"}]}], "Input",
 PageWidth->PaperWidth,
 CellChangeTimes->{{3.939181592577593*^9, 3.939181652604529*^9}, {
   3.9398112311171513`*^9, 3.9398112318267517`*^9}, {3.93981129599738*^9, 
   3.939811321059803*^9}, {3.939811522763155*^9, 3.93981152566778*^9}, {
   3.9398116441766376`*^9, 3.9398116511637087`*^9}, {3.939879798737522*^9, 
   3.939879863484466*^9}, 3.939883485303514*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"e921cbd1-6133-874e-807f-16322a268886"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["r", "b"], "-", 
      SuperscriptBox["\[Beta]", "\[Prime]",
       MultilineFunction->None]}], ")"}], " ", 
    SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
     MultilineFunction->None]}], 
   RowBox[{
    SuperscriptBox["\[Beta]", "2"], "+", 
    RowBox[{
     SubscriptBox["r", "a"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["r", "b"]}], "+", 
       SuperscriptBox["\[Beta]", "\[Prime]",
        MultilineFunction->None]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.939181655750939*^9, {3.939811311744243*^9, 3.939811321531311*^9}, 
   3.939811526128769*^9, 3.939811657817087*^9, 3.939879867467495*^9, 
   3.939879920657499*^9, 3.939883473502973*^9, 3.93988351939616*^9, 
   3.9418704854164276`*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"2418a7fb-aa8f-3c4e-801e-6d851b32dd81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "b"], "->", 
        RowBox[{"\[Lambda]", "+", "\[Beta]", "+", 
         RowBox[{"\[Beta]", "'"}], "+", 
         RowBox[{"\[Beta]", "'''"}]}]}], ",", 
       RowBox[{
        SubscriptBox["r", "a"], "->", 
        RowBox[{"\[Lambda]", "+", "\[Beta]", "+", 
         RowBox[{"\[Beta]", "''"}]}]}]}], "}"}]}], "//", "FullSimplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]", "''"}], "->", "1"}], ",", " ", 
       RowBox[{"\[Beta]", "->", "1"}], ",", 
       RowBox[{
        RowBox[{"\[Beta]", "'"}], "->", "1"}], ",", 
       RowBox[{
        RowBox[{"\[Beta]", "'''"}], "->", "1"}], ",", 
       RowBox[{"\[Lambda]", "->", "1"}]}], "}"}]}], "*)"}]}]}]], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"d3d880ce-6991-de45-b7b5-47f5ab0d29b2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
    MultilineFunction->None], " ", 
   RowBox[{"(", 
    RowBox[{"\[Beta]", "+", "\[Lambda]", "+", 
     SuperscriptBox["\[Beta]", 
      TagBox[
       RowBox[{"(", "3", ")"}],
       Derivative],
      MultilineFunction->None]}], ")"}]}], 
  RowBox[{
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "\[Beta]"}], "+", "\[Lambda]"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Beta]", "+", "\[Lambda]"}], ")"}], " ", 
    SuperscriptBox["\[Beta]", 
     TagBox[
      RowBox[{"(", "3", ")"}],
      Derivative],
     MultilineFunction->None]}], "+", 
   RowBox[{
    SuperscriptBox["\[Beta]", "\[Prime]\[Prime]",
     MultilineFunction->None], " ", 
    RowBox[{"(", 
     RowBox[{"\[Beta]", "+", "\[Lambda]", "+", 
      SuperscriptBox["\[Beta]", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.939181655750939*^9, {3.939811311744243*^9, 3.939811321531311*^9}, 
   3.939811526128769*^9, 3.9398116578251743`*^9, 3.9418704854477863`*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"23e703d5-339c-1648-b7c2-916f12f633ee"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
e.g.U2.0) Now let\[CloseCurlyQuote]s try with something a little more \
complex: 2x2 square lattice with total absorption at 1.\
\>", "Subitem",
 CellChangeTimes->{{3.9391819899725876`*^9, 3.93918205437681*^9}, {
  3.9398932448535175`*^9, 3.9398932449533443`*^9}, {3.939893308812788*^9, 
  3.939893308885271*^9}},ExpressionUUID->"8553ac77-6161-2949-abd4-\
688b7afc2120"],

Cell[CellGroupData[{

Cell["\<\
Let\[CloseCurlyQuote]s start by defining the partition function: recall \
e.g.3.1\
\>", "Subsubitem",
 CellChangeTimes->{{3.9391820569564037`*^9, 
  3.939182104103937*^9}},ExpressionUUID->"4827bca4-adc6-d74a-b0b6-\
310c16fe26f8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "j"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "k"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Z", "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939182110271591*^9, 3.939182117720415*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"8717c0a9-cd31-f24d-8067-90f46f7bd087"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   SuperscriptBox["r", "2"]]}]], "Output",
 CellChangeTimes->{
  3.939182118069439*^9, 3.939184758252136*^9, 3.9391848087843246`*^9, {
   3.939893361669428*^9, 3.939893382407081*^9}, 3.941870485480137*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"f47bb7a5-d0b9-f442-9e3b-e2f6b254cc9e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U2.1)Now define the observable U: let\[CloseCurlyQuote]s start with the \
probability to get the path 01. As in e.g. U1.1, we need the trick of an \
extra vertex between 0 and 1.\t\tCORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.939182902689361*^9}, {3.9398932470366325`*^9, 
  3.939893247409258*^9}},ExpressionUUID->"50e7fd92-007d-0c47-8a2c-\
ea2f3bfdfb11"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"0", ",", "1"}], "]"}], 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "l"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "l"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", "\[Delta]ruleExternalMod"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.939182408594867*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.939182773283504*^9, 3.939182780813949*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.939183149879507*^9, 
   3.939183151800907*^9}, {3.939893407048233*^9, 3.939893413655618*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"e11c4b1f-2e0e-e848-8388-4002a1a9446c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r", "-", "\[Beta]"}], ")"}], " ", "\[Beta]", " ", 
   RowBox[{"(", 
    RowBox[{"r", "+", "\[Beta]"}], ")"}]}], 
  RowBox[{
   SuperscriptBox["r", "3"], "-", 
   RowBox[{"2", " ", "r", " ", 
    SuperscriptBox["\[Beta]", "2"]}]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.939182774931916*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, 3.939183152181364*^9, {
   3.939893384773638*^9, 3.939893414006984*^9}, 3.941870485526615*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"83541277-12de-1244-b580-a3de0deab326"],

Cell[BoxData[
 FractionBox["3", "4"]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.939182774931916*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, 3.939183152181364*^9, {
   3.939893384773638*^9, 3.939893414006984*^9}, 3.941870485526615*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"74e96a3f-75ae-c943-88c8-b225beab2bc0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U2.2)Now define the observable U for the probability to get the path 0231. \t\
\tCORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.93918293796421*^9}, {3.9398932507914333`*^9, 
  3.9398932509086*^9}},ExpressionUUID->"fbb20c4e-fe6e-b049-aabc-c68507587a5c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"3", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "l"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "l"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[Delta]ruleExternal"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.939182408594867*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.939182773283504*^9, 3.939182780813949*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.9391829441877975`*^9, 
   3.939182994914551*^9}, {3.939183131713098*^9, 3.93918316084577*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"b4c8ab98-563a-d041-8313-3e5b4080480f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"D\[Delta]", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"D\[Delta]", "[", "3", "]"}], "2"], " ", 
    RowBox[{"D\[Delta]", "[", 
     SuperscriptBox["b", "\[Prime]",
      MultilineFunction->None], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", 
      SuperscriptBox["b", "\[Prime]",
       MultilineFunction->None]}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"Zeta", "[", "5", "]"}], "3"], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"1", ",", "3", ",", "2"}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"2", ",", "2", ",", "3"}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"3", ",", "1", ",", "1"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"Zeta", "[", "3", "]"}], "3"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"D\[Delta]", "[", "0", "]"}], " ", 
    RowBox[{"D\[Delta]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"D\[Delta]", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"D\[Delta]", "[", "3", "]"}], "2"], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"2", ",", "0"}], "]"}], " ", 
    RowBox[{"D\[Delta]", "[", 
     RowBox[{"3", ",", "2"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"Zeta", "[", "5", "]"}], "3"], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"1", ",", "1", ",", "2"}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"2", ",", "2", ",", "3"}], "]"}], " ", 
    RowBox[{"\[Delta]", "[", 
     RowBox[{"3", ",", "3", ",", "1"}], "]"}]}], 
   SuperscriptBox[
    RowBox[{"Zeta", "[", "3", "]"}], "3"]]}]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.9391827749319158`*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9, 3.9418704855578747`*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"0428540f-cabc-eb4c-a1bc-2da4e2c5228f"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[Beta]", "3"], " ", 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"2", ",", "2", ",", "3"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"1", ",", "3", ",", "2"}], "]"}], " ", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"3", ",", "1", ",", "1"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], " ", 
      RowBox[{"\[Delta]", "[", 
       RowBox[{"3", ",", "3", ",", "1"}], "]"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["r", "3"], "-", 
   RowBox[{"2", " ", "r", " ", 
    SuperscriptBox["\[Beta]", "2"]}]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.9391827749319158`*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9, 3.9418704855578747`*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"ab2161ed-78dc-464a-9c93-be80b7208333"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"\[Delta]", "[", 
   RowBox[{"2", ",", "2", ",", "3"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      RowBox[{"1", ",", "3", ",", "2"}], "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"3", ",", "1", ",", "1"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"\[Delta]", "[", 
      RowBox[{"1", ",", "1", ",", "2"}], "]"}], " ", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"3", ",", "3", ",", "1"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.9391827749319158`*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9, 3.9418704855578747`*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"a195e122-3428-3c4b-b41d-0f87a369274d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U2.3)Now define the observable U for the probability to get the path 231. \t\t\
CORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.93918293796421*^9}, {3.93918477149016*^9, 3.9391847755848217`*^9}, {
  3.9398932541854973`*^9, 
  3.9398932549062195`*^9}},ExpressionUUID->"f4fa26c4-3d9e-604e-a2ad-\
6934014d3152"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"3", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "j"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "j"}], "]"}]}]}], ")"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "k"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "k"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r", "->", "2"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.939182408594867*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.939182773283504*^9, 3.939182780813949*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.9391829441877975`*^9, 
   3.939182994914551*^9}, {3.939183131713098*^9, 3.93918316084577*^9}, {
   3.939184779784386*^9, 3.9391848309468174`*^9}, {3.939184865995825*^9, 
   3.939184875986511*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"a33ae952-3835-b947-a9fd-202a9eec3c2d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[Beta]", "2"], " ", 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"2", ",", "2", ",", "3"}], "]"}], " ", 
   RowBox[{"\[Delta]", "[", 
    RowBox[{"3", ",", "3", ",", "1"}], "]"}]}], 
  RowBox[{
   SuperscriptBox["r", "2"], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Beta]", "2"]}]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.9391827749319158`*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9, {3.939184787725231*^9, 
   3.939184802315684*^9}, {3.939184862471579*^9, 3.9391848761915016`*^9}, 
   3.9418704855892067`*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"30ed5b76-214f-9f46-acb5-f1067b0e8a3b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"\[Delta]", "[", 
   RowBox[{"2", ",", "2", ",", "3"}], "]"}], " ", 
  RowBox[{"\[Delta]", "[", 
   RowBox[{"3", ",", "3", ",", "1"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.9391827749319158`*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, {3.939182982572281*^9, 
   3.9391829952143364`*^9}, 3.9391831614136124`*^9, {3.939184787725231*^9, 
   3.939184802315684*^9}, {3.939184862471579*^9, 3.9391848761915016`*^9}, 
   3.9418704855892067`*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"8a65e452-e13c-f547-bacf-7385788ecc7d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
e.g.U3) Now even more complex: 3x3 square lattice with total absorption at 4 \
(the vertex in the center).\
\>", "Subitem",
 CellChangeTimes->{{3.9391819899725876`*^9, 3.93918205437681*^9}, {
  3.939183402330759*^9, 
  3.9391834403447495`*^9}},ExpressionUUID->"a8ad6383-460c-1949-96ab-\
6a88ab777456"],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s start by defining the partition function: ", \
"Subsubitem",
 CellChangeTimes->{{3.9391820569564037`*^9, 3.939182104103937*^9}, {
  3.939183444567276*^9, 
  3.939183444721752*^9}},ExpressionUUID->"8a566e29-c1b3-c14e-88a5-\
c540ee416bca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i0"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i0"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i0"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i0"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "1"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i2"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "i2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"5", ",", "i2"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "i2"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"6", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "5"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"8", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "6"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i6"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"6", ",", "i6"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"7", ",", "i6"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"6", ",", "i6"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "7"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"6", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"8", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "8"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"7", ",", "i8"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"8", ",", "i8"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"5", ",", "i8"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"8", ",", "i8"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "3", "]"}], "->", "r2"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "->", "r3"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Z", "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939182110271591*^9, 3.939182117720415*^9}, {
   3.939183458579991*^9, 3.939183740234572*^9}, 3.93918411011722*^9, {
   3.939184150814396*^9, 3.939184201941395*^9}, {3.939184250661186*^9, 
   3.939184260306963*^9}, 3.9391850983113403`*^9, {3.93918513021941*^9, 
   3.939185132281181*^9}, {3.93918544114534*^9, 3.93918545026754*^9}, {
   3.939185486321318*^9, 3.939185487288252*^9}, {3.93918556002746*^9, 
   3.9391855610523458`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"9bf57419-8f49-d540-b265-ff7eea825cfe"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"8", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   RowBox[{"r2", " ", "r3"}]], "+", 
  FractionBox[
   RowBox[{"20", " ", 
    SuperscriptBox["\[Beta]", "4"]}], 
   RowBox[{
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "2"]}]], "-", 
  FractionBox[
   RowBox[{"16", " ", 
    SuperscriptBox["\[Beta]", "6"]}], 
   RowBox[{
    SuperscriptBox["r2", "3"], " ", 
    SuperscriptBox["r3", "3"]}]]}]], "Output",
 CellChangeTimes->{
  3.939182118069439*^9, 3.939183749972637*^9, 3.939184117146916*^9, 
   3.9391842092995625`*^9, 3.939185019229126*^9, 3.9391851020363083`*^9, 
   3.9391851363027134`*^9, {3.9391854505499134`*^9, 3.939185491251844*^9}, 
   3.939185565057417*^9, {3.9418704801619415`*^9, 3.9418704889630566`*^9}, 
   3.9418707061119576`*^9},
 CellLabel->
  "Out[179]=",ExpressionUUID->"53bf6ff1-827e-534f-a9de-9fc05ffacefc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Z"], "Input",
 CellChangeTimes->{3.9418706963940334`*^9},
 CellLabel->
  "In[180]:=",ExpressionUUID->"d5410e24-1fde-2040-ab53-ca506ecffc68"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"8", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   RowBox[{"r2", " ", "r3"}]], "+", 
  FractionBox[
   RowBox[{"20", " ", 
    SuperscriptBox["\[Beta]", "4"]}], 
   RowBox[{
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "2"]}]], "-", 
  FractionBox[
   RowBox[{"16", " ", 
    SuperscriptBox["\[Beta]", "6"]}], 
   RowBox[{
    SuperscriptBox["r2", "3"], " ", 
    SuperscriptBox["r3", "3"]}]]}]], "Output",
 CellChangeTimes->{{3.9418706965356216`*^9, 3.9418707169140015`*^9}},
 CellLabel->
  "Out[180]=",ExpressionUUID->"9dc7625a-9e86-ea4a-8da8-eda144484ffa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Z", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r2", "->", "2"}], ",", 
    RowBox[{"r3", "->", "3"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9391842662853384`*^9, 3.9391842673531094`*^9}, {
  3.94187064007345*^9, 3.941870682535595*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"be3d8018-4699-8048-aed3-825cdd74f85c"],

Cell[BoxData[
 FractionBox["4", "27"]], "Output",
 CellChangeTimes->{3.9391842680450177`*^9, 3.939185479785518*^9, 
  3.9418704890588856`*^9, 3.941870683860693*^9, 3.9418707200778427`*^9},
 CellLabel->
  "Out[181]=",ExpressionUUID->"93017726-9c6f-1643-bdd6-655407a094e6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U3.1)Now define the observable U: let\[CloseCurlyQuote]s start with the \
probability to get the path 014. As in e.g. U1.1, we need the trick of an \
extra vertex between 0 and 1 and 1 and 4.\t\tCORRECT!!!!! \
CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.9391829026893616`*^9}, {3.9391838032228374`*^9, 3.939183810189192*^9}, {
  3.939185604416374*^9, 3.939185606736088*^9}, {3.939186671366974*^9, 
  3.939186672599283*^9}},ExpressionUUID->"f83500ec-da75-344f-9572-\
76d9879c7185"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"4", ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i0"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i0"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "i0"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i0"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "1"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"c", "'"}], ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "i2"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "i2"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"5", ",", "i2"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "i2"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"6", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "5"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"8", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "6"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "i6"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"6", ",", "i6"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"7", ",", "i6"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"6", ",", "i6"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "7"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"6", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"8", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "8"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"7", ",", "i8"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"8", ",", "i8"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"5", ",", "i8"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"8", ",", "i8"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "l"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "l"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"c", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"c", "'"}], ",", "i"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{"\[Delta]", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]rule"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r2"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "7", "]"}], "->", "r3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r2", "->", "2"}], ",", 
    RowBox[{"r3", "->", "3"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.939182408594867*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.939182773283504*^9, 3.939182780813949*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.939183149879507*^9, 
   3.939183151800907*^9}, {3.9391838391244164`*^9, 3.9391838408345985`*^9}, {
   3.939183878904241*^9, 3.939183940062308*^9}, {3.9391840317185*^9, 
   3.939184032943518*^9}, 3.93918406474202*^9, {3.9391842744922714`*^9, 
   3.939184337752743*^9}, {3.939185617244182*^9, 3.939185666218721*^9}, {
   3.94187096500593*^9, 3.941870970587332*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"812706c6-d56b-4f47-94f5-78a8639f5005"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["r2", "3"], " ", 
    SuperscriptBox["r3", "3"], " ", 
    SuperscriptBox["\[Beta]", "2"]}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"]}], "+", 
   RowBox[{"6", " ", "r2", " ", "r3", " ", 
    SuperscriptBox["\[Beta]", "6"]}], "-", 
   SuperscriptBox["\[Beta]", "8"]}], 
  RowBox[{"r2", " ", "r3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", " ", "r3"}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["\[Beta]", "2"]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r2", " ", "r3"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Beta]", "2"]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.9391827749319158`*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, 3.939183152181364*^9, 
   3.9391839140119877`*^9, 3.939183974496311*^9, 3.939184059322275*^9, 
   3.9391841029884243`*^9, 3.9391843675125933`*^9, 3.9391857325356636`*^9, 
   3.9418705002312946`*^9, 3.9418708069559383`*^9, 3.9418710089694614`*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"01271d1a-8195-a542-85f2-e29b1210561c"],

Cell[BoxData[
 FractionBox["71", "192"]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.939182629165006*^9, {3.9391827749319158`*^9, 
   3.939182783299574*^9}, 3.939182859859241*^9, 3.939183152181364*^9, 
   3.9391839140119877`*^9, 3.939183974496311*^9, 3.939184059322275*^9, 
   3.9391841029884243`*^9, 3.9391843675125933`*^9, 3.9391857325356636`*^9, 
   3.9418705002312946`*^9, 3.9418708069559383`*^9, 3.9418710089694614`*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"c6f973ff-cac1-9440-bb6c-693e5c4c62ce"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
e.g.U4)  3x3 square lattice with total absorption at 8 (a vertex in the \
corner).\
\>", "Subitem",
 CellChangeTimes->{{3.9391819899725876`*^9, 3.93918205437681*^9}, {
  3.939183402330759*^9, 3.9391834403447495`*^9}, {3.939189109542589*^9, 
  3.9391891274649887`*^9}},ExpressionUUID->"b455b96b-4427-fa42-9e37-\
4e9236061472"],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s start by defining the partition function: ", \
"Subsubitem",
 CellChangeTimes->{{3.9391820569564037`*^9, 3.939182104103937*^9}, {
  3.939183444567276*^9, 
  3.939183444721752*^9}},ExpressionUUID->"6b9e2fd7-9424-8141-890a-\
ae33722dbbce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"From", " ", "0"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i0"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i0"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i0"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"0", ",", "i0"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "1"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i1"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"1", ",", "i1"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "2"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i2"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "i2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"5", ",", "i2"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"2", ",", "i2"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "3"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"0", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"6", ",", "i3"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"3", ",", "i3"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "4"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"1", ",", "i4"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"4", ",", "i4"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i4"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"4", ",", "i4"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"5", ",", "i4"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"4", ",", "i4"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "9", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"7", ",", "i4"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"4", ",", "i4"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "5"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"2", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"8", ",", "i5"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"5", ",", "i5"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "6"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"3", ",", "i6"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"6", ",", "i6"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "3", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"7", ",", "i6"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"6", ",", "i6"}], "]"}]}]}], ")"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"From", " ", "7"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"6", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"4", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Zeta", "[", "5", "]"}], "/", 
          RowBox[{"Zeta", "[", "7", "]"}]}], 
         RowBox[{"\[Phi]s", "[", 
          RowBox[{"8", ",", "i7"}], "]"}], "*", 
         RowBox[{"\[Phi]", "[", 
          RowBox[{"7", ",", "i7"}], "]"}]}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
     "Expand"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "->", 
      RowBox[{
       RowBox[{"\[Delta]", "[", 
        RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
       RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
     "vertices", " ", "of", " ", "the", " ", "loop"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "3", "]"}], "->", "r2"}], ",", 
       RowBox[{
        RowBox[{"Zeta", "[", "7", "]"}], "->", "r3"}], ",", " ", 
       RowBox[{
        RowBox[{"Zeta", "[", "9", "]"}], "->", "r4"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Z", "=", 
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "->", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], 
      "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.939182110271591*^9, 3.939182117720415*^9}, {
   3.939183458579991*^9, 3.939183740234572*^9}, 3.93918411011722*^9, {
   3.939184150814396*^9, 3.939184201941395*^9}, {3.939184250661186*^9, 
   3.939184260306963*^9}, 3.9391850983113403`*^9, {3.93918513021941*^9, 
   3.939185132281181*^9}, {3.93918544114534*^9, 3.93918545026754*^9}, {
   3.939185486321318*^9, 3.939185487288252*^9}, {3.93918556002746*^9, 
   3.939185561052346*^9}, {3.939189139829271*^9, 3.939189234708452*^9}, {
   3.939189267653012*^9, 3.93918927101326*^9}, 3.9397057450750847`*^9},
 CellLabel->
  "In[152]:=",ExpressionUUID->"1c083c4d-58a9-154f-a306-5520853d16bf"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"6", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   RowBox[{"r2", " ", "r3"}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["\[Beta]", "2"]}], 
   RowBox[{"r3", " ", "r4"}]], "+", 
  FractionBox[
   RowBox[{"10", " ", 
    SuperscriptBox["\[Beta]", "4"]}], 
   RowBox[{
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "2"]}]], "+", 
  FractionBox[
   RowBox[{"12", " ", 
    SuperscriptBox["\[Beta]", "4"]}], 
   RowBox[{"r2", " ", 
    SuperscriptBox["r3", "2"], " ", "r4"}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox["\[Beta]", "6"]}], 
   RowBox[{
    SuperscriptBox["r2", "3"], " ", 
    SuperscriptBox["r3", "3"]}]], "-", 
  FractionBox[
   RowBox[{"8", " ", 
    SuperscriptBox["\[Beta]", "6"]}], 
   RowBox[{
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "3"], " ", "r4"}]]}]], "Output",
 CellChangeTimes->{
  3.939182118069439*^9, 3.939183749972637*^9, 3.939184117146916*^9, 
   3.9391842092995625`*^9, 3.939185019229126*^9, 3.9391851020363083`*^9, 
   3.9391851363027134`*^9, {3.9391854505499134`*^9, 3.939185491251844*^9}, 
   3.939185565057417*^9, {3.9391892505827446`*^9, 3.939189278107697*^9}, 
   3.939705732400091*^9, 3.9418705151047573`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"afdb8e31-f431-5945-a818-6a87a0ae18f3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "%"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r2", "->", "2"}], ",", 
    RowBox[{"r3", "->", "3"}], ",", 
    RowBox[{"r4", "->", "4"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.9391842662853394`*^9, 3.9391842673531094`*^9}, {
  3.939189237648411*^9, 3.939189241403975*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"13e31e42-20fa-bc45-80bd-5e4e05a65170"],

Cell[BoxData[
 FractionBox["4", "729"]], "Output",
 CellChangeTimes->{
  3.9391842680450187`*^9, 3.939185479785518*^9, {3.939189252750128*^9, 
   3.939189281988809*^9}, 3.93970573621455*^9, 3.9418705345580654`*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"4dfb5575-21b1-f44b-8a0b-03fa2e8ac787"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
U4.1)Now define the observable U: let\[CloseCurlyQuote]s start with the \
probability to get the path 01478. As in e.g. U1.1, we need the trick of an \
extra vertex between 0 and 1 and 1 and 4.\t\tCORRECT!!!!! \
CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!CORRECT!!!!!\
\>", "Subsubitem",
 CellChangeTimes->{{3.939182131435692*^9, 3.939182194165268*^9}, {
  3.93918223418058*^9, 3.939182275317379*^9}, {3.9391828818546333`*^9, 
  3.9391829026893616`*^9}, {3.9391838032228374`*^9, 3.939183810189192*^9}, {
  3.939185604416374*^9, 3.939185606736088*^9}, {3.939186671366974*^9, 
  3.939186672599283*^9}, {3.939189292774023*^9, 
  3.9391893019780064`*^9}},ExpressionUUID->"dab72dd3-f296-a547-ae5c-\
23d82e9dc0c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"7", ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "5"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"7", ",", "5"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "5"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"c", "'"}], ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"4", ",", "4"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"4", ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "3"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"b", "'"}], ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "*", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "*", 
    RowBox[{"\[Phi]s", "[", 
     RowBox[{"0", ",", "1"}], "]"}], "*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "0"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "i0"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i0"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "i0"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"0", ",", "i0"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "1"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{
         RowBox[{"c", "'"}], ",", "i1"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"1", ",", "i1"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "2"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "i2"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "i2"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"5", ",", "i2"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"2", ",", "i2"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "3"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"0", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"6", ",", "i3"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"3", ",", "i3"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "5"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"2", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"8", ",", "i5"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"5", ",", "i5"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "6"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"3", ",", "i6"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"6", ",", "i6"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"7", ",", "i6"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"6", ",", "i6"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "7"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"6", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "7", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"8", ",", "i7"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"7", ",", "i7"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", "8"}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"7", ",", "i8"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"8", ",", "i8"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"Zeta", "[", "5", "]"}], "/", 
        RowBox[{"Zeta", "[", "3", "]"}]}], 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"5", ",", "i8"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"8", ",", "i8"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"b", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"1", ",", "l"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"b", "'"}], ",", "l"}], "]"}]}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"From", " ", 
      RowBox[{"c", "'"}]}], "*)"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"4", ",", "i"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"c", "'"}], ",", "i"}], "]"}]}]}], ")"}]}], 
   RowBox[{"(*", 
    RowBox[{"single", " ", "flavour", " ", "contribution"}], "*)"}], "//", 
   "Expand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "nihilpotency"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"x_", ",", "a_"}], "]"}], "*", 
       RowBox[{"\[Phi]s", "[", 
        RowBox[{"x_", ",", "b_"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}], ")"}]}], ":>", 
     RowBox[{
      RowBox[{"\[Delta]", "[", 
       RowBox[{"a", ",", "b", ",", "x"}], "]"}], 
      RowBox[{"D\[Delta]", "[", "x", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "D\[Delta]", " ", "reminds", " ", "us", " ", "the", " ", 
    "vertices", " ", "of", " ", "the", " ", "loop"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"x_", ",", "a_"}], "]"}], "*", 
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"y_", ",", "b_"}], "]"}]}], "->", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//.", "\[CapitalSigma]\[Delta]ruleMod"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", "\[Delta]ruleExternal"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", "//.", "\[CapitalSigma]D\[Delta]ruleMod"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Zeta", "[", "5", "]"}], "->", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "3", "]"}], "->", "r2"}], ",", 
     RowBox[{
      RowBox[{"Zeta", "[", "7", "]"}], "->", "r3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "->", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{
      RowBox[{"D\[Delta]", "[", "a__", "]"}], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "Z"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Beta]", "->", "1"}], ",", 
    RowBox[{"r2", "->", "2"}], ",", 
    RowBox[{"r3", "->", "3"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.939182210874214*^9, 3.939182230019455*^9}, {
   3.939182281291044*^9, 3.9391823740334167`*^9}, {3.9391824085948677`*^9, 
   3.9391824226832523`*^9}, {3.9391825573680687`*^9, 3.9391825578699512`*^9}, 
   3.939182628835964*^9, {3.9391827732835045`*^9, 3.9391827808139496`*^9}, {
   3.939182847481638*^9, 3.93918285911738*^9}, {3.939183149879507*^9, 
   3.939183151800907*^9}, {3.9391838391244164`*^9, 3.9391838408345985`*^9}, {
   3.9391838789042416`*^9, 3.9391839400623074`*^9}, {3.9391840317185*^9, 
   3.9391840329435177`*^9}, 3.9391840647420197`*^9, {3.9391842744922714`*^9, 
   3.939184337752743*^9}, {3.9391856172441826`*^9, 3.9391856662187214`*^9}, {
   3.939189446688919*^9, 
   3.9391895287014713`*^9}},ExpressionUUID->"79ceda6c-ad2d-5349-b1ec-\
e251df942bf4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["r2", "3"], " ", 
    SuperscriptBox["r3", "3"], " ", 
    SuperscriptBox["\[Beta]", "2"]}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox["r2", "2"], " ", 
    SuperscriptBox["r3", "2"], " ", 
    SuperscriptBox["\[Beta]", "4"]}], "+", 
   RowBox[{"6", " ", "r2", " ", "r3", " ", 
    SuperscriptBox["\[Beta]", "6"]}], "-", 
   SuperscriptBox["\[Beta]", "8"]}], 
  RowBox[{"r2", " ", "r3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"r2", " ", "r3"}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox["\[Beta]", "2"]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r2", " ", "r3"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Beta]", "2"]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, 3.939183152181364*^9, 
   3.9391839140119877`*^9, 3.939183974496311*^9, 3.939184059322275*^9, 
   3.9391841029884243`*^9, 3.9391843675125923`*^9, 3.9391857325356636`*^9},
 CellLabel->
  "Out[494]=",ExpressionUUID->"c354b90c-a3e9-254e-93c7-8f3dda96d18f"],

Cell[BoxData[
 FractionBox["71", "192"]], "Output",
 CellChangeTimes->{{3.939182382017912*^9, 3.939182423053362*^9}, 
   3.939182559392126*^9, 3.9391826291650066`*^9, {3.9391827749319153`*^9, 
   3.939182783299574*^9}, 3.9391828598592415`*^9, 3.939183152181364*^9, 
   3.9391839140119877`*^9, 3.939183974496311*^9, 3.939184059322275*^9, 
   3.9391841029884243`*^9, 3.9391843675125923`*^9, 3.9391857325436287`*^9},
 CellLabel->
  "Out[495]=",ExpressionUUID->"fe449c6e-172e-cf46-9edd-6ca832af73bf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 831.75},
WindowMargins->{{1146, Automatic}, {Automatic, -6}},
CellContext->Notebook,
Magnification:>1. Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b1f16191-099a-3f4d-82be-d8ee8f67dcdd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 171, 3, 98, "Title",ExpressionUUID->"a0f2e223-41ca-ae44-afc0-bade21e41e2f"],
Cell[754, 27, 415, 8, 64, "Input",ExpressionUUID->"d33a729d-ad37-1f47-8d81-b5e2850f5f1e",
 InitializationCell->True],
Cell[1172, 37, 499, 10, 81, "Text",ExpressionUUID->"71729c60-6479-ed42-a4ab-a58eebcf0641"],
Cell[CellGroupData[{
Cell[1696, 51, 154, 3, 67, "Section",ExpressionUUID->"786f8d7a-cd7a-2343-95e9-004997b2505d"],
Cell[1853, 56, 14026, 308, 711, "Input",ExpressionUUID->"c4d1690f-e7a4-5549-ad2a-79f0aa122e5f",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[15904, 368, 271, 4, 54, "Subsection",ExpressionUUID->"f3e50ec4-01de-d54d-96cd-4f8287cf06a0"],
Cell[16178, 374, 565, 10, 56, "Text",ExpressionUUID->"762f7555-840b-0c45-9dee-ef60631940f7"],
Cell[CellGroupData[{
Cell[16768, 388, 1751, 38, 143, "Input",ExpressionUUID->"a2e09d6d-e664-7748-9a0f-495c53860306"],
Cell[18522, 428, 5750, 106, 152, "Output",ExpressionUUID->"394a7aca-e5b9-414b-ba17-27bd86156c50"],
Cell[24275, 536, 5545, 104, 307, "Output",ExpressionUUID->"6ff2f679-0317-6e41-9fcb-cfcec2d02dd5"],
Cell[29823, 642, 1905, 26, 32, "Output",ExpressionUUID->"51e352a4-44b2-1d43-a380-d06a09101901"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31765, 673, 727, 12, 48, "Input",ExpressionUUID->"4488a7f2-a843-7145-a876-6f20d3e7e3b9"],
Cell[32495, 687, 4840, 101, 307, "Output",ExpressionUUID->"54532202-b025-0142-a113-7c66a241b54c"],
Cell[37338, 790, 1695, 41, 52, "Output",ExpressionUUID->"58e154e2-df5c-5845-baa3-7dc3dc2e8592"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[39094, 838, 278, 4, 53, "Section",ExpressionUUID->"942fdf5b-eea6-534a-971f-0437f51d9830"],
Cell[39375, 844, 272, 6, 35, "Text",ExpressionUUID->"fe0f2a7f-16bb-984b-b561-73d909146d31"],
Cell[39650, 852, 1265, 22, 83, "Input",ExpressionUUID->"3159f7aa-122c-8441-9c37-61ddfeeb1078",
 InitializationCell->True],
Cell[40918, 876, 7701, 178, 593, "Input",ExpressionUUID->"db7e8836-8040-e740-ab88-d7aeebd7bfeb",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[48644, 1058, 185, 3, 54, "Subsection",ExpressionUUID->"5bf8cdd6-e456-6f4f-848f-884a07a83784"],
Cell[CellGroupData[{
Cell[48854, 1065, 525, 11, 28, "Input",ExpressionUUID->"54bf71a2-b5ec-3d47-88e2-1188593be31a"],
Cell[49382, 1078, 2544, 73, 51, "Output",ExpressionUUID->"d9fed051-3042-444d-9f6d-a3ccce66401f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51963, 1156, 455, 11, 28, "Input",ExpressionUUID->"1a852724-628d-3741-93af-8fd861028ce1"],
Cell[52421, 1169, 1142, 35, 51, "Output",ExpressionUUID->"c43bb2c1-c040-0747-9124-1f78f887d64b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53624, 1211, 185, 3, 67, "Section",ExpressionUUID->"a2c15434-00a5-1046-99b7-6b6dad2cb4d2"],
Cell[53812, 1216, 2113, 58, 126, "Input",ExpressionUUID->"d59eaaf1-117b-954d-bc47-5fd957e1a5e2",
 InitializationCell->True],
Cell[55928, 1276, 912, 27, 83, "Input",ExpressionUUID->"515c84b6-0497-1743-b842-40bcf1b416f6",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[56865, 1307, 187, 3, 54, "Subsection",ExpressionUUID->"c45f1d94-0f68-604d-b333-98dd93c2c294"],
Cell[CellGroupData[{
Cell[57077, 1314, 372, 10, 28, "Input",ExpressionUUID->"d8a193d6-b365-5a4d-80c2-121376ada22f"],
Cell[57452, 1326, 338, 7, 32, "Output",ExpressionUUID->"a51ceec1-fef5-604b-aba2-62392b34df30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57827, 1338, 369, 10, 28, "Input",ExpressionUUID->"f769d7df-def1-8b4a-9504-e6aeae032a74"],
Cell[58199, 1350, 225, 4, 32, "Output",ExpressionUUID->"65be1f3b-2e7a-9e47-989b-238a4cd51b3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58461, 1359, 437, 12, 28, "Input",ExpressionUUID->"af0133a1-c660-924c-9060-6dfd430f18c4"],
Cell[58901, 1373, 256, 5, 32, "Output",ExpressionUUID->"69b0c013-5bd8-fc48-b027-d20cb6a8ee4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59194, 1383, 418, 11, 28, "Input",ExpressionUUID->"36fb3397-f498-764b-a7d8-6d010e0ab158"],
Cell[59615, 1396, 153, 3, 32, "Output",ExpressionUUID->"11c1f0cb-f685-0845-9373-02a82807c901"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59805, 1404, 420, 11, 28, "Input",ExpressionUUID->"53d63093-299c-454e-b79e-285fbcfdcc88"],
Cell[60228, 1417, 153, 3, 32, "Output",ExpressionUUID->"94edd3cb-fd7b-a148-899a-43bfb194a0d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60418, 1425, 554, 15, 28, "Input",ExpressionUUID->"0bcefcd6-aba8-4940-894b-3478f723bc9e"],
Cell[60975, 1442, 155, 3, 32, "Output",ExpressionUUID->"b1a318ac-22da-6942-82a8-63fe80d76456"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[61191, 1452, 217, 4, 53, "Section",ExpressionUUID->"6c013ccf-6700-5943-89ed-25a319a30c0e"],
Cell[61411, 1458, 159, 3, 35, "Text",ExpressionUUID->"9efd4005-5c4e-ac42-82b5-48fbdc4cb51c"],
Cell[61573, 1463, 20003, 447, 1662, "Input",ExpressionUUID->"c588350e-729f-e341-8de4-dd68d96b95d2",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[81601, 1914, 184, 3, 54, "Subsection",ExpressionUUID->"92fd9b38-ed75-c041-a45b-a8ac5a25805a"],
Cell[CellGroupData[{
Cell[81810, 1921, 115, 2, 32, "Item",ExpressionUUID->"fe886783-654d-9e44-897d-e114eca62974"],
Cell[CellGroupData[{
Cell[81950, 1927, 1376, 36, 124, "Input",ExpressionUUID->"970e6115-d263-2f45-8ec0-f397f46ab323"],
Cell[83329, 1965, 2546, 73, 51, "Output",ExpressionUUID->"f6f79369-4fc8-2141-a6d6-90225ffc5f39"],
Cell[85878, 2040, 2655, 74, 51, "Output",ExpressionUUID->"fa6a0a0c-c5e7-4242-a7cd-cd0567571573"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88582, 2120, 222, 4, 32, "Item",ExpressionUUID->"132eb6e4-547d-cd46-8739-b3725de90bd8"],
Cell[CellGroupData[{
Cell[88829, 2128, 1630, 41, 143, "Input",ExpressionUUID->"ddc4c380-612c-484b-b7a6-2e8c81c2b1ba"],
Cell[90462, 2171, 3489, 97, 51, "Output",ExpressionUUID->"530e5101-4cdb-ae4c-89bc-7ec47f791241"],
Cell[93954, 2270, 1722, 43, 50, "Output",ExpressionUUID->"9b51379b-1032-3d41-af99-462ad29ee284"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95725, 2319, 198, 3, 32, "Item",ExpressionUUID->"2c35eda2-cfce-d743-9a51-cf21e5efcfc7"],
Cell[CellGroupData[{
Cell[95948, 2326, 1341, 39, 162, "Input",ExpressionUUID->"83fe4051-e207-eb4a-bc69-c65d4b4921fc"],
Cell[97292, 2367, 3214, 100, 91, "Output",ExpressionUUID->"35aafaff-a24b-2445-877b-6dffe5a843e5"],
Cell[100509, 2469, 1326, 42, 50, "Output",ExpressionUUID->"7e33eed3-fc77-5245-96d0-b9dd6ac1704e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[101908, 2519, 74, 0, 67, "Section",ExpressionUUID->"5115fb5e-76b6-b449-b950-db4c42c19aab"],
Cell[CellGroupData[{
Cell[102007, 2523, 529, 9, 32, "Item",ExpressionUUID->"79ff84b5-8f52-354a-8abb-0141ba4fffee"],
Cell[102539, 2534, 523, 9, 25, "Subsubitem",ExpressionUUID->"539045f2-e12e-f740-a199-c241b5b317fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103099, 2548, 349, 5, 32, "Item",ExpressionUUID->"31116618-da27-1d4a-85a6-754212ab01f6"],
Cell[103451, 2555, 607, 14, 26, "Subitem",ExpressionUUID->"fedbeb3d-3112-1f4b-9df1-67ec93f26a6a"],
Cell[104061, 2571, 825, 13, 45, "Subitem",ExpressionUUID->"07b41a31-a66d-b94f-8038-5ec3cb977be5"],
Cell[CellGroupData[{
Cell[104911, 2588, 584, 10, 26, "Subitem",ExpressionUUID->"2aa48082-2775-ef43-b8df-87e820637338"],
Cell[105498, 2600, 722, 15, 48, "Input",ExpressionUUID->"26d07459-8f8c-0b4c-98da-5920d2d2e881"],
Cell[CellGroupData[{
Cell[106245, 2619, 1040, 27, 67, "Input",ExpressionUUID->"0b794d01-a48c-684b-bfab-b10bb6379e2f"],
Cell[107288, 2648, 756, 21, 32, "Output",ExpressionUUID->"2dec9736-1918-d841-b109-feeace776901"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108093, 2675, 278, 5, 26, "Subitem",ExpressionUUID->"b171f651-1cd1-c14b-a825-4622ed538a0f"],
Cell[108374, 2682, 1963, 48, 48, "Input",ExpressionUUID->"f230b126-0c88-5d45-b8b1-6872d54b7e27"],
Cell[110340, 2732, 2233, 54, 67, "Input",ExpressionUUID->"8f0c5aa7-f172-2244-95d1-2a233962f71a"],
Cell[112576, 2788, 1777, 39, 48, "Input",ExpressionUUID->"66b2709d-c021-1a4c-9429-5dbd0a0561ac"],
Cell[CellGroupData[{
Cell[114378, 2831, 453, 11, 28, "Input",ExpressionUUID->"be0fdbc9-33b4-6a40-aaca-9b38b7bda553"],
Cell[114834, 2844, 253, 6, 32, "Output",ExpressionUUID->"cf6245b3-ad00-7345-a449-6bbb07266ba8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115136, 2856, 329, 7, 26, "Subitem",ExpressionUUID->"c0e96f75-58d7-5146-b483-878f45e80c15"],
Cell[115468, 2865, 957, 26, 48, "Input",ExpressionUUID->"261adeb5-dab9-2249-94b2-d22287175407"],
Cell[116428, 2893, 931, 26, 48, "Input",ExpressionUUID->"5bae1f8b-782e-2145-b382-a133483fd60b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117396, 2924, 251, 4, 26, "Subitem",ExpressionUUID->"9ae37851-07b4-ee45-b599-6a9f52e2c880"],
Cell[CellGroupData[{
Cell[117672, 2932, 3125, 92, 182, "Input",ExpressionUUID->"c20a91b7-8a7e-ac48-981e-7ce77c901821"],
Cell[120800, 3026, 652, 15, 50, "Output",ExpressionUUID->"7b2b3c5c-2a31-c64c-8c44-73962e1f4c40"],
Cell[121455, 3043, 630, 15, 52, "Output",ExpressionUUID->"3858ec54-f4d7-c343-90b9-95893e9e1095"],
Cell[122088, 3060, 498, 12, 52, "Output",ExpressionUUID->"182da0eb-aca8-5a43-a25d-14c1d2974b17"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122635, 3078, 655, 11, 45, "Subitem",ExpressionUUID->"ae10d59d-ec9c-0a44-bf94-a5d9839ac1c2"],
Cell[CellGroupData[{
Cell[123315, 3093, 4259, 121, 181, "Input",ExpressionUUID->"d022a4c7-ba46-ca4f-93a4-78118a84b278"],
Cell[127577, 3216, 642, 12, 51, "Output",ExpressionUUID->"2d55c2ea-329c-d84f-a373-9095c840de79"],
Cell[128222, 3230, 667, 13, 50, "Output",ExpressionUUID->"048ce62e-ee2a-944c-aef8-e041ea7a1204"],
Cell[128892, 3245, 593, 11, 50, "Output",ExpressionUUID->"9d3e784a-0700-f945-b7da-cbfa3fb9aa03"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129534, 3262, 665, 11, 45, "Subitem",ExpressionUUID->"5b9fd806-f94c-5a44-954b-ab372ccb3a73"],
Cell[CellGroupData[{
Cell[130224, 3277, 4247, 119, 314, "Input",ExpressionUUID->"30fde334-9436-4d41-a62c-741e1f70b2c9"],
Cell[134474, 3398, 749, 17, 53, "Output",ExpressionUUID->"d3179959-a76b-ff41-8e07-8567263f569f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135260, 3420, 479, 12, 28, "Input",ExpressionUUID->"89dcc36f-f472-bd44-9dc5-1cf21f4541e3"],
Cell[135742, 3434, 284, 7, 48, "Output",ExpressionUUID->"d108f653-d0b9-e745-a94e-5d0fcc2efced"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[136075, 3447, 604, 10, 26, "Subitem",ExpressionUUID->"95f6d0ff-e871-a248-8411-f5b605eff070"],
Cell[CellGroupData[{
Cell[136704, 3461, 5145, 147, 219, "Input",ExpressionUUID->"43e26709-a0ee-fb4d-9581-f1ea14cca791"],
Cell[141852, 3610, 2866, 79, 92, "Output",ExpressionUUID->"cebe269d-f262-dd4e-8d42-ac46909fe95d"],
Cell[144721, 3691, 466, 10, 51, "Output",ExpressionUUID->"b9e8418f-cb6a-ba4a-bb4c-c4c273f53cf4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145224, 3706, 302, 7, 28, "Input",ExpressionUUID->"69a43f82-ca57-1441-80bf-33e24774125a"],
Cell[145529, 3715, 171, 2, 32, "Output",ExpressionUUID->"35a73865-2f28-d240-ae64-9db64a817d6b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[145749, 3723, 567, 10, 26, "Subitem",ExpressionUUID->"2cf23a1f-8588-4440-9337-ec3b1e737975"],
Cell[CellGroupData[{
Cell[146341, 3737, 4554, 128, 200, "Input",ExpressionUUID->"d8a11bcc-572e-6b47-b65f-6f9b7cfa1d91"],
Cell[150898, 3867, 944, 21, 51, "Output",ExpressionUUID->"e7e38040-d029-6341-aa06-457c363255a0"],
Cell[151845, 3890, 588, 11, 51, "Output",ExpressionUUID->"bd53ef60-bd60-d748-8ccd-9e84a44403b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152470, 3906, 302, 7, 28, "Input",ExpressionUUID->"306f2050-30a1-d243-a8e8-dfe2d161a62c"],
Cell[152775, 3915, 287, 5, 47, "Output",ExpressionUUID->"e135ef2a-d604-864d-8491-6b9ff38a9f27"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[153111, 3926, 566, 10, 26, "Subitem",ExpressionUUID->"61c94159-63f8-5341-9856-d93ac2d3bd47"],
Cell[CellGroupData[{
Cell[153702, 3940, 4971, 140, 219, "Input",ExpressionUUID->"d6b250c9-9aa9-584e-9b42-a8d8917fb56a"],
Cell[158676, 4082, 1894, 50, 92, "Output",ExpressionUUID->"72534e13-1027-0e4a-bf6b-cc7e58388d07"],
Cell[160573, 4134, 540, 11, 51, "Output",ExpressionUUID->"9eac7e62-08dc-b840-99b5-319c52a447c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161150, 4150, 302, 7, 28, "Input",ExpressionUUID->"32d902ce-f1ff-6347-ab19-985341a9cdde"],
Cell[161455, 4159, 265, 5, 47, "Output",ExpressionUUID->"000e7fd5-579a-4941-89ee-17b024495381"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[161781, 4171, 402, 8, 53, "Item",ExpressionUUID->"09f88d79-ca2e-c945-aa7e-efb0e4f7fe04"],
Cell[CellGroupData[{
Cell[162208, 4183, 686, 12, 45, "Subitem",ExpressionUUID->"0cd69e85-42c3-234a-8755-cfed69381d90"],
Cell[CellGroupData[{
Cell[162919, 4199, 6233, 179, 297, "Input",ExpressionUUID->"fb48d549-3742-d049-a247-e0780461886a"],
Cell[169155, 4380, 1666, 40, 53, "Output",ExpressionUUID->"202b769b-53e4-bf46-a341-94afb7ce7767"],
Cell[170824, 4422, 1824, 44, 53, "Output",ExpressionUUID->"a6fa2be9-5e1d-e842-8814-f24431ed6ca7"],
Cell[172651, 4468, 2177, 56, 56, "Output",ExpressionUUID->"43846a77-30c9-c741-ae22-665b3b5f4fd1"],
Cell[174831, 4526, 1247, 26, 48, "Output",ExpressionUUID->"3457024b-3244-9541-8f4b-ccab5dd2f033"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[176127, 4558, 538, 9, 45, "Subitem",ExpressionUUID->"adacadf2-0bd8-e545-9de2-540c674467a2"],
Cell[CellGroupData[{
Cell[176690, 4571, 5173, 150, 430, "Input",ExpressionUUID->"e921cbd1-6133-874e-807f-16322a268886"],
Cell[181866, 4723, 939, 26, 51, "Output",ExpressionUUID->"2418a7fb-aa8f-3c4e-801e-6d851b32dd81"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182842, 4754, 1019, 29, 67, "Input",ExpressionUUID->"d3d880ce-6991-de45-b7b5-47f5ab0d29b2"],
Cell[183864, 4785, 1263, 38, 58, "Output",ExpressionUUID->"23e703d5-339c-1648-b7c2-916f12f633ee"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[185176, 4829, 380, 7, 26, "Subitem",ExpressionUUID->"8553ac77-6161-2949-abd4-688b7afc2120"],
Cell[CellGroupData[{
Cell[185581, 4840, 239, 6, 25, "Subsubitem",ExpressionUUID->"4827bca4-adc6-d74a-b0b6-310c16fe26f8"],
Cell[CellGroupData[{
Cell[185845, 4850, 4217, 124, 200, "Input",ExpressionUUID->"8717c0a9-cd31-f24d-8067-90f46f7bd087"],
Cell[190065, 4976, 398, 10, 51, "Output",ExpressionUUID->"f47bb7a5-d0b9-f442-9e3b-e2f6b254cc9e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[190512, 4992, 497, 9, 43, "Subsubitem",ExpressionUUID->"50e7fd92-007d-0c47-8a2c-ea2f3bfdfb11"],
Cell[CellGroupData[{
Cell[191034, 5005, 5591, 166, 276, "Input",ExpressionUUID->"e11c4b1f-2e0e-e848-8388-4002a1a9446c"],
Cell[196628, 5173, 674, 16, 50, "Output",ExpressionUUID->"83541277-12de-1244-b580-a3de0deab326"],
Cell[197305, 5191, 411, 7, 48, "Output",ExpressionUUID->"74e96a3f-75ae-c943-88c8-b225beab2bc0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[197765, 5204, 391, 7, 25, "Subsubitem",ExpressionUUID->"fbb20c4e-fe6e-b049-aabc-c68507587a5c"],
Cell[CellGroupData[{
Cell[198181, 5215, 5694, 166, 295, "Input",ExpressionUUID->"b4c8ab98-563a-d041-8313-3e5b4080480f"],
Cell[203878, 5383, 2415, 62, 97, "Output",ExpressionUUID->"0428540f-cabc-eb4c-a1bc-2da4e2c5228f"],
Cell[206296, 5447, 1077, 27, 53, "Output",ExpressionUUID->"ab2161ed-78dc-464a-9c93-be80b7208333"],
Cell[207376, 5476, 918, 22, 47, "Output",ExpressionUUID->"a195e122-3428-3c4b-b41d-0f87a369274d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[208343, 5504, 446, 9, 25, "Subsubitem",ExpressionUUID->"f4fa26c4-3d9e-604e-a2ad-6934014d3152"],
Cell[CellGroupData[{
Cell[208814, 5517, 5293, 153, 276, "Input",ExpressionUUID->"a33ae952-3835-b947-a9fd-202a9eec3c2d"],
Cell[214110, 5672, 831, 19, 53, "Output",ExpressionUUID->"30ed5b76-214f-9f46-acb5-f1067b0e8a3b"],
Cell[214944, 5693, 692, 14, 47, "Output",ExpressionUUID->"8a65e452-e13c-f547-bacf-7385788ecc7d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[215697, 5714, 311, 7, 27, "Subitem",ExpressionUUID->"a8ad6383-460c-1949-96ab-6a88ab777456"],
Cell[CellGroupData[{
Cell[216033, 5725, 266, 5, 25, "Subsubitem",ExpressionUUID->"8a566e29-c1b3-c14e-88a5-c540ee416bca"],
Cell[CellGroupData[{
Cell[216324, 5734, 9636, 271, 390, "Input",ExpressionUUID->"9bf57419-8f49-d540-b265-ff7eea825cfe"],
Cell[225963, 6007, 911, 25, 53, "Output",ExpressionUUID->"53bf6ff1-827e-534f-a9de-9fc05ffacefc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226911, 6037, 154, 3, 28, "Input",ExpressionUUID->"d5410e24-1fde-2040-ab53-ca506ecffc68"],
Cell[227068, 6042, 638, 20, 53, "Output",ExpressionUUID->"9dc7625a-9e86-ea4a-8da8-eda144484ffa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227743, 6067, 394, 10, 28, "Input",ExpressionUUID->"be3d8018-4699-8048-aed3-825cdd74f85c"],
Cell[228140, 6079, 271, 5, 46, "Output",ExpressionUUID->"93017726-9c6f-1643-bdd6-655407a094e6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[228460, 6090, 682, 11, 42, "Subsubitem",ExpressionUUID->"f83500ec-da75-344f-9572-76d9879c7185"],
Cell[CellGroupData[{
Cell[229167, 6105, 11294, 333, 485, "Input",ExpressionUUID->"812706c6-d56b-4f47-94f5-78a8639f5005"],
Cell[240464, 6440, 1316, 33, 55, "Output",ExpressionUUID->"01271d1a-8195-a542-85f2-e29b1210561c"],
Cell[241783, 6475, 568, 9, 46, "Output",ExpressionUUID->"c6f973ff-cac1-9440-bb6c-693e5c4c62ce"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[242412, 6491, 335, 7, 26, "Subitem",ExpressionUUID->"b455b96b-4427-fa42-9e37-4e9236061472"],
Cell[CellGroupData[{
Cell[242772, 6502, 266, 5, 24, "Subsubitem",ExpressionUUID->"6b9e2fd7-9424-8141-890a-ae33722dbbce"],
Cell[CellGroupData[{
Cell[243063, 6511, 10429, 290, 295, "Input",ExpressionUUID->"1c083c4d-58a9-154f-a306-5520853d16bf"],
Cell[253495, 6803, 1370, 40, 51, "Output",ExpressionUUID->"afdb8e31-f431-5945-a818-6a87a0ae18f3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254902, 6848, 450, 12, 28, "Input",ExpressionUUID->"13e31e42-20fa-bc45-80bd-5e4e05a65170"],
Cell[255355, 6862, 297, 6, 47, "Output",ExpressionUUID->"4dfb5575-21b1-f44b-8a0b-03fa2e8ac787"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[255701, 6874, 735, 12, 43, "Subsubitem",ExpressionUUID->"dab72dd3-f296-a547-ae5c-23d82e9dc0c3"],
Cell[CellGroupData[{
Cell[256461, 6890, 11678, 344, 409, "Input",ExpressionUUID->"79ceda6c-ad2d-5349-b1ec-e251df942bf4"],
Cell[268142, 7236, 1244, 32, 57, "Output",ExpressionUUID->"c354b90c-a3e9-254e-93c7-8f3dda96d18f"],
Cell[269389, 7270, 496, 8, 47, "Output",ExpressionUUID->"fe449c6e-172e-cf46-9edd-6ca832af73bf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

